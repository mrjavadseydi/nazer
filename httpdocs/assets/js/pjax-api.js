/**
 * Minified by jsDelivr using Terser v5.13.1.
 * Original file: /npm/pjax-api@3.35.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/*! pjax-api v3.35.0 https://github.com/falsandtru/pjax-api | (c) 2012, falsandtru | (Apache-2.0 AND MPL-2.0) License */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["pjax-api"]=t():e["pjax-api"]=t()}(globalThis,(()=>(()=>{var e={8767:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(4279);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return i(o).default}}),s(r(4279),t)},5406:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=t.ObjectValues=t.ObjectSetPrototypeOf=t.ObjectSeal=t.ObjectPreventExtensions=t.ObjectKeys=t.isSealed=t.isFrozen=t.isExtensible=t.ObjectIs=t.ObjectGetPrototypeOf=t.ObjectGetOwnPropertySymbols=t.ObjectGetOwnPropertyNames=t.ObjectGetOwnPropertyDescriptors=t.ObjectGetOwnPropertyDescriptor=t.ObjectFromEntries=t.ObjectFreeze=t.ObjectEntries=t.ObjectDefineProperty=t.ObjectDefineProperties=t.ObjectCreate=t.ObjectAssign=t.toString=t.isEnumerable=t.isPrototypeOf=t.hasOwnProperty=t.SymbolKeyFor=t.SymbolFor=t.sign=t.round=t.random=t.min=t.max=t.floor=t.ceil=t.abs=t.parseInt=t.parseFloat=t.isSafeInteger=t.isNaN=t.isInteger=t.isFinite=t.NaN=void 0,t.NaN=Number.NaN,t.isFinite=Number.isFinite,t.isInteger=Number.isInteger,t.isNaN=Number.isNaN,t.isSafeInteger=Number.isSafeInteger,t.parseFloat=Number.parseFloat,t.parseInt=Number.parseInt,t.abs=Math.abs,t.ceil=Math.ceil,t.floor=Math.floor,t.max=Math.max,t.min=Math.min,t.random=Math.random,t.round=Math.round,t.sign=Math.sign,t.SymbolFor=Symbol.for,t.SymbolKeyFor=Symbol.keyFor,t.hasOwnProperty=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),t.isPrototypeOf=Object.prototype.isPrototypeOf.call.bind(Object.prototype.isPrototypeOf),t.isEnumerable=Object.prototype.propertyIsEnumerable.call.bind(Object.prototype.propertyIsEnumerable),t.toString=Object.prototype.toString.call.bind(Object.prototype.toString),t.ObjectAssign=Object.assign,t.ObjectCreate=Object.create,t.ObjectDefineProperties=Object.defineProperties,t.ObjectDefineProperty=Object.defineProperty,t.ObjectEntries=Object.entries,t.ObjectFreeze=Object.freeze,t.ObjectFromEntries=Object.fromEntries,t.ObjectGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,t.ObjectGetOwnPropertyDescriptors=Object.getOwnPropertyDescriptors,t.ObjectGetOwnPropertyNames=Object.getOwnPropertyNames,t.ObjectGetOwnPropertySymbols=Object.getOwnPropertySymbols,t.ObjectGetPrototypeOf=Object.getPrototypeOf,t.ObjectIs=Object.is,t.isExtensible=Object.isExtensible,t.isFrozen=Object.isFrozen,t.isSealed=Object.isSealed,t.ObjectKeys=Object.keys,t.ObjectPreventExtensions=Object.preventExtensions,t.ObjectSeal=Object.seal,t.ObjectSetPrototypeOf=Object.setPrototypeOf,t.ObjectValues=Object.values,t.isArray=Array.isArray},8112:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.join=t.splice=t.pop=t.push=t.shift=t.unshift=t.indexOf=void 0;const n=r(4128);function s(e,t){if("length"in e)for(let r=e.length-1;r>=0;--r)t.unshift(e[r]);else t.unshift(...e);return t}function i(e,t){if("length"in t)for(let r=0,n=t.length;r<n;++r)e.push(t[r]);else for(const r of t)e.push(r);return e}function o(e,t,r,...c){if(0===r&&0===c.length)return[];switch(r=r>e.length?e.length:r,t){case 0:switch(r){case 0:return[[],s(c,e)][0];case 1:return 0===e.length?[[],s(c,e)][0]:[[e.shift()],s(c,e)][0];case void 0:if(e.length>1||arguments.length>2)break;return 0===e.length?[]:o(e,t,1)}break;case-1:case e.length-1:switch(r){case 1:return 0===e.length?[[],i(e,c)][0]:[[e.pop()],i(e,c)][0];case void 0:if(e.length>1||arguments.length>2)break;return 0===e.length?[]:o(e,t,1)}break;case e.length:case n.Infinity:return[[],i(e,c)][0]}return arguments.length>2?e.splice(t,r,...c):e.splice(t)}t.indexOf=function(e,t){return 0===e.length?-1:t==t?e.indexOf(t):e.findIndex((e=>e!=e))},t.unshift=s,t.shift=function(e,t){if(t<0)throw new Error("Unexpected negative number");return void 0===t?[e.shift(),e]:[o(e,0,t),e]},t.push=i,t.pop=function(e,t){if(t<0)throw new Error("Unexpected negative number");return void 0===t?[e,e.pop()]:[e,o(e,e.length-t,t)]},t.splice=o,t.join=function(e,t=""){let r="";for(let n=0;n<e.length;++n)r+=0===n?e[n]:t+e[n];return r}},4401:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.template=t.inherit=t.merge=t.extend=t.overwrite=t.clone=t.assign=void 0;const n=r(4128),s=r(5406),i=r(5177),o=r(8112);function c(e){return function(t,...r){if((0,i.isPrimitive)(t))return t;for(let n=0;n<r.length;++n){const o=r[n];if(o===t)continue;if((0,i.isPrimitive)(o))continue;const c=(0,s.ObjectKeys)(o);for(let r=0;r<c.length;++r)e(c[r],t,o)}return t}}function a(e){return e instanceof n.Object?{}:(0,s.ObjectCreate)(null)}t.assign=c(((e,t,r)=>t[e]=r[e])),t.clone=c(((e,r,n)=>{switch((0,i.type)(n[e])){case"Array":return r[e]=n[e].slice();case"Object":return"Object"===(0,i.type)(r[e])?r[e]=(0,t.clone)(a(n[e]),n[e]):r[e]=n[e];default:return r[e]=n[e]}})),t.overwrite=c(((e,r,n)=>{switch((0,i.type)(n[e])){case"Array":default:return r[e]=n[e];case"Object":return"Object"===(0,i.type)(r[e])?(0,t.overwrite)(r[e],n[e]):r[e]=(0,t.overwrite)(a(n[e]),n[e])}})),t.extend=c(((e,r,n)=>{switch((0,i.type)(n[e])){case"undefined":return;case"Array":default:return r[e]=n[e];case"Object":return"Object"===(0,i.type)(r[e])?(0,t.extend)(r[e],n[e]):r[e]=(0,t.extend)(a(n[e]),n[e])}})),t.merge=c(((e,r,n)=>{switch((0,i.type)(n[e])){case"undefined":return;case"Array":return"Array"===(0,i.type)(r[e])?r[e]=(0,o.push)(r[e],n[e]):r[e]=n[e].slice();case"Object":return"Object"===(0,i.type)(r[e])?(0,t.merge)(r[e],n[e]):r[e]=(0,t.merge)(a(n[e]),n[e]);default:return r[e]=n[e]}})),t.inherit=c(((e,r,n)=>{switch((0,i.type)(n[e])){case"undefined":return;case"Array":return r[e]=n[e].slice();case"Object":return"Object"===(0,i.type)(r[e])?(0,s.hasOwnProperty)(r,e)?(0,t.inherit)(r[e],n[e]):r[e]=(0,t.inherit)((0,s.ObjectCreate)(r[e]),n[e]):r[e]=(0,s.ObjectCreate)(n[e]);default:return r[e]=n[e]}})),t.template=c},9210:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;const n=r(4128),s=r(7681),i=r(7452),o=r(4401),c=r(5341);class a{constructor(e,t={}){if(this.settings={capacity:0,space:n.Infinity,age:n.Infinity,life:10,limit:95,capture:{delete:!0,clear:!0}},this.SIZE=0,this.clock=n.Number.MIN_SAFE_INTEGER,this.clockR=n.Number.MIN_SAFE_INTEGER,this.memory=new n.Map,this.indexes={LRU:new i.List,LFU:new i.List,OVL:new i.List},this.stats={LRU:(0,c.tuple)(0,0),LFU:(0,c.tuple)(0,0),slide(){const{LRU:e,LFU:t}=this;e[1]=e[0],e[0]=0,t[1]=t[0],t[0]=0},clear(){const{LRU:e,LFU:t}=this;e[0]=e[1]=0,t[0]=t[1]=0}},this.ratio=50,"object"==typeof e&&(e=(t=e).capacity??0),(0,o.extend)(this.settings,t,{capacity:e}),this.capacity=this.settings.capacity,this.capacity>=1==!1)throw new Error("Spica: Cache: Capacity must be 1 or more.");this.space=this.settings.space,this.life=this.capacity*this.settings.life,this.limit=this.settings.limit}get length(){return this.indexes.LRU.length+this.indexes.LFU.length}get size(){return this.SIZE}evict(e,t,r){const n=e.value;r&&=!!this.settings.disposer,t=r?t??this.memory.get(n.key):t,e.delete(),e.value.overlap?.delete(),this.memory.delete(n.key),this.SIZE-=n.size,r&&this.settings.disposer?.(t.value,n.key)}ensure(e,t){t&&(t.value.clock=this.clock,t.value.expiry=n.Infinity);let r=t?.value.size??0;if(e-r<=0)return;const{LRU:i,LFU:o,OVL:c}=this.indexes;for(;this.length===this.capacity||this.size+e-r>this.space;){const e=c.last??o.last,a=e?.value;let u;switch(!0){case a&&a.clock<this.clock-this.life:case a&&a.expiry!==n.Infinity&&a.expiry<(0,s.now)():u=e.list===c?e.value.node:e;break;case 0===i.length:u=o.last!==t?o.last:o.last.prev;break;case o.length>this.capacity*this.ratio/100:if(u=o.last!==t?o.last:o.length>=2?o.last.prev:t,u!==t){if(this.ratio>=50)break;i.unshiftNode(u),i.head.value.node=i.head,i.head.value.overlap=c.unshift(i.head.value)}default:u=i.last!==t?i.last:i.length>=2?i.last.prev:o.last}this.evict(u,void 0,!0),r=(t=t?.list&&t)?.value.size??0}}put(e,t,r=1,i=this.settings.age){if(r>=1==!1)throw new Error("Spica: Cache: Size must be 1 or more.");if(i>=1==!1)throw new Error("Spica: Cache: Age must be 1 or more.");if(r>this.space||i<=0)return this.settings.disposer?.(t,e),!1;const o=i===n.Infinity?n.Infinity:(0,s.now)()+i,c=this.memory.get(e);if(c){const n=c.index,s=c.value,i=n.value;return this.ensure(r,n),i.clock="LRU"===i.region?++this.clockR:++this.clock,i.expiry=o,this.SIZE+=r-i.size,i.size=r,c.value=t,this.settings.disposer?.(s,e),!0}this.ensure(r);const{LRU:a}=this.indexes;return this.SIZE+=r,this.memory.set(e,{index:a.unshift({key:e,size:r,clock:++this.clockR,expiry:o,region:"LRU"}),value:t}),!1}set(e,t,r,n){return this.put(e,t,r,n),this}get(e){const t=this.memory.get(e);if(!t)return;const r=t.index,i=r.value.expiry;if(!(i!==n.Infinity&&i<(0,s.now)()))return this.capacity>=10&&r===r.list.head||(this.access(r),this.slide()),t.value;this.evict(r,t,!0)}has(e){const t=this.memory.get(e);if(!t)return!1;const r=t.index.value.expiry;return!(r!==n.Infinity&&r<(0,s.now)())||(this.evict(t.index,t,!0),!1)}delete(e){const t=this.memory.get(e);return!!t&&(this.evict(t.index,t,!0===this.settings.capture.delete),!0)}clear(){if(this.SIZE=0,this.ratio=50,this.stats.clear(),this.indexes.LRU.clear(),this.indexes.LFU.clear(),this.indexes.OVL.clear(),!this.settings.disposer||!this.settings.capture.clear)return void this.memory.clear();const e=this.memory;this.memory=new n.Map;for(const[t,{value:r}]of e)this.settings.disposer(r,t)}*[Symbol.iterator](){for(const[e,{value:t}]of this.memory)yield[e,t]}slide(){const{LRU:e,LFU:t}=this.stats,{capacity:r,ratio:n,limit:s,indexes:i}=this,o=r;if(e[0]+t[0]===o&&this.stats.slide(),100*(e[0]+t[0])%r||e[1]+t[1]===0)return;const c=i.LRU.length,a=i.LFU.length,l=1e3*(a+i.OVL.length)/(c+a)|0,h=u(o,e[0],e[0]+t[0],e[1],e[1]+t[1],0)*(1+l),d=u(o,t[0],e[0]+t[0],t[1],e[1]+t[1],0)*(1001-l),p=u(o,t[1],e[1]+t[1],t[0],e[0]+t[0],5)*(1001-l);n>0&&(h>d||d<.95*p)?c>=r*(100-n)/100&&--this.ratio:n<s&&d>h&&a>=r*n/100&&++this.ratio}access(e){return this.accessLFU(e)||this.accessLRU(e)}accessLRU(e){const t=e.value,{LRU:r,LFU:n}=this.indexes;return++this.stats[t.region][0],!t.overlap&&t.clock>=this.clockR-r.length/3&&this.capacity>3?(t.clock=++this.clockR,e.moveToHead(),!0):(t.clock=++this.clock,t.region="LFU",t.overlap?.delete(),n.unshiftNode(e),!0)}accessLFU(e){const t=e.value,{LFU:r}=this.indexes;return e.list===r&&(++this.stats[t.region][0],t.clock=++this.clock,e.moveToHead(),!0)}}function u(e,t,r,n,s,i){const o=100*n/s|0,c=100*r/e-i|0;if(c<=0)return 100*o;return(100*t/r|0)*c+o*(100-c)}t.Cache=a},412:(e,t,r)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.Cancellation=void 0;const i=r(4879),o=r(3387),c=r(7822),a=r(6512),u=r(8555),l=r(6288),h=Symbol.for("spica/cancellation::internal");class d{constructor(e=[]){this[n]="Cancellation",this[s]=new p;for(const t of e)t.register(this.cancel)}get[(n=Symbol.toStringTag,s=h,i.internal)](){return this[h].promise[i.internal]}get isAlive(){return 0===this[h].reason.length}get isCancelled(){return 1===this[h].reason.length}get isClosed(){return 2===this[h].reason.length}get isFinished(){return 0!==this[h].reason.length}get register(){return e=>this[h].register(e)}get cancel(){return e=>this[h].cancel(e)}get close(){return e=>this[h].close(e)}get then(){return this[h].promise.then}get catch(){return this[h].promise.catch}get finally(){return this[h].promise.finally}get promise(){return e=>this.isCancelled?i.AtomicPromise.reject(this[h].reason[0]):i.AtomicPromise.resolve(e)}get maybe(){return e=>(0,a.Just)(e).bind((e=>this.isCancelled?a.Nothing:(0,a.Just)(e)))}get either(){return e=>(0,u.Right)(e).bind((e=>this.isCancelled?(0,u.Left)(this[h].reason[0]):(0,u.Right)(e)))}}t.Cancellation=d;class p{constructor(){this.isFinished=!1,this.reason=[],this.listeners=[]}get promise(){if(!this.future)switch(this.future=new o.AtomicFuture,this.reason.length){case 1:return this.future.bind(this.reason[0]);case 2:return this.future.bind(i.AtomicPromise.reject(this.reason[1]))}return this.future}register(e){if(this.isFinished)return 1===this.reason.length&&r(this.reason[0]),l.noop;const t=this.listeners.push(r)-1;return()=>this.listeners[t]=void 0;function r(t){try{e(t)}catch(t){(0,c.causeAsyncException)(t)}}}cancel(e){if(0===this.reason.length){this.reason=[e];for(let t=0,{listeners:r}=this;t<r.length;++t)r[t]?.(e);this.future?.bind(e),this.isFinished=!0}}close(e){0===this.reason.length&&(this.reason=[void 0,e],this.future?.bind(i.AtomicPromise.reject(e)),this.isFinished=!0)}}},9802:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Channel=void 0;const n=r(4879),s=r(3387),i=()=>n.AtomicPromise.reject(new Error("Spica: Channel: Closed.")),o=Symbol.for("spica/channel::internal");class c{constructor(e=0){this[o]=new a(e)}get isAlive(){return this[o].isAlive}close(e){if(!this.isAlive)return;const t=this[o],{buffer:r,producers:s,consumers:c}=t;for(t.isAlive=!1;s.length||c.length;)s.length&&s.shift().bind(i()),c.length&&c.shift().bind(i());e&&n.AtomicPromise.all(r).then(e)}put(e){if(!this.isAlive)return i();const{capacity:t,buffer:r,producers:c,consumers:a}=this[o];switch(!0){case r.length<t:case a.length>0:return r.push(e),a.length>0&&a.shift().bind(r.shift()),n.AtomicPromise.resolve();default:return c[c.push(new s.AtomicFuture)-1].then((()=>this.put(e)))}}take(){if(!this.isAlive)return i();const{buffer:e,producers:t,consumers:r}=this[o];switch(!0){case e.length>0:const i=e.shift();return t.length>0&&t.shift().bind(),n.AtomicPromise.resolve(i);case t.length>0:const o=r[r.push(new s.AtomicFuture)-1];return t.shift().bind(),o.then();default:return r[r.push(new s.AtomicFuture)-1].then()}}get size(){return this[o].buffer.length}async*[Symbol.asyncIterator](){try{for(;this.isAlive;)yield this.take()}catch(e){if(this.isAlive)throw e}}}t.Channel=c;class a{constructor(e=0){this.capacity=e,this.isAlive=!0,this.buffer=[],this.producers=[],this.consumers=[]}}},7681:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tick=t.clock=t.now=void 0;const n=r(4128),s=r(5406),i=r(7822);let o,c=0;t.now=function(e=!1){if(void 0===o)d((()=>o=void 0));else if(!e&&100!=++c)return o;return c=0,o=n.Date.now()},t.clock=Promise.resolve(void 0);let a=[],u=[],l=0;const h=Promise.resolve();function d(e){0===l&&h.then(p),l++===a.length?a.push(e):a[l-1]=e}function p(){const e=l;[l,a,u]=[0,u,a];for(let t=0;t<e;++t)try{(0,u[t])(),u[t]=void 0}catch(e){(0,i.causeAsyncException)(e)}u.length>1e3&&e<.5*u.length&&u.splice((0,s.floor)(.9*u.length),u.length)}t.tick=d},5529:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.equal=void 0,t.equal=function(e,t){return e==e?e===t:t!=t}},7596:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Copropagator=void 0;const n=r(4128),s=r(5406),i=r(7983),o=r(4879);class c extends i.Coroutine{constructor(e,t=(e=>e[0]),r){super((async function*(){return this.then((t=>{for(const r of e)r[i.Coroutine.exit](t)}),(t=>{const r=o.AtomicPromise.reject(t);for(const t of e)t[i.Coroutine.exit](r)})),a(e).then((e=>0===e.length?void this[i.Coroutine.terminate](new n.Error("Spica: Copropagator: No result.")):void this[i.Coroutine.exit](t(e))),(e=>{this[i.Coroutine.terminate](e)})),o.never}),{delay:!1,...r})}}function a(e,t){const r=(0,s.isArray)(e)?e:[...e];return o.AtomicPromise.all(r).then((i=>{const o=(0,s.isArray)(e)?e:[...e],c=o.length===r.length&&o.every(((e,t)=>o[t]===r[t]));if(!t&&c)return i;t??=new n.Map;for(let e=0;e<i.length;++e)t.set(r[e],i[e]);return c?[...t.values()]:a(o,t)}))}t.Copropagator=c},7983:(e,t,r)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.isCoroutine=t.Coroutine=void 0;const i=r(4128),o=r(5406),c=r(7681),a=r(4879),u=r(3387),l=r(9802),h=r(8520),d=r(6288),p=r(7822),f=Symbol.for("spica/Coroutine.isAlive"),m=Symbol.for("spica/Coroutine.init"),v=Symbol.for("spica/Coroutine.exit"),y=Symbol.for("spica/Coroutine.terminate"),b=Symbol.for("spica/Coroutine.port"),g=Symbol.for("spica/coroutine::internal");class w extends a.AtomicPromise{constructor(e,t={}){var r;super((e=>r=e)),this[n]=new O(this),this[g]=new S(t);let s=0;this[w.init]=async()=>{const t=this[g];if(!t.isAlive)return;if(0!==s)return;let r=d.noop;try{const n=e.call(this);for(;t.isAlive;){const[[e,o]]=1==++s?[[void 0,d.noop]]:await i.Promise.all([t.settings.capacity<0?[void 0,d.noop]:t.sendBuffer.take(),i.Promise.all([t.settings.resume(),t.settings.interval>0?(0,h.wait)(t.settings.interval):void 0])]);if(r=o,!t.isAlive)break;const c=await n.next(e);if(c.done)return t.isAlive=!1,r({...c}),t.recvBuffer.put({...c}),void t.result.bind(c);r({...c}),await t.recvBuffer.put({...c})}r(a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Canceled.")))}catch(e){r(a.AtomicPromise.reject(e)),this[w.terminate](e)}};const u=this[g];if(r(u.result.then((({value:e})=>e))),void 0!==u.settings.trigger)for(const e of(0,i.Array)().concat(u.settings.trigger))if(!(e in this)||!this.hasOwnProperty(e))if(e in this)(0,o.ObjectDefineProperty)(this,e,{set(t){delete this[e],this[e]=t,this[m]()},get(){return delete this[e],this[m](),this[e]},enumerable:!0,configurable:!0});else{const t=(0,o.ObjectGetOwnPropertyDescriptor)(this,e)||{value:this[e],enumerable:!0,configurable:!0,writable:!0};(0,o.ObjectDefineProperty)(this,e,{set(r){(0,o.ObjectDefineProperty)(this,e,{...t,value:r}),this[m]()},get(){return this[e]},enumerable:!0,configurable:!0})}this[g].settings.run&&(this[g].settings.delay?(0,c.tick)(this[w.init]):this[w.init]())}get[f](){return this[g].isAlive}[v](e){this[g].isAlive&&a.AtomicPromise.resolve(e).then((e=>{const t=this[g];t.isAlive&&(t.isAlive=!1,t.recvBuffer.put({value:void 0,done:!0}),t.result.bind({value:e}))}),(e=>{const t=this[g];t.isAlive&&(t.isAlive=!1,t.recvBuffer.put({value:void 0,done:!0}),t.result.bind(a.AtomicPromise.reject(e)))}))}[y](e){return this[v](a.AtomicPromise.reject(e))}async*[Symbol.asyncIterator](){const e=this[g],t=this[w.port];for(;e.isAlive;){const e=await t.recv();if(e.done)return e.value;yield e.value}return this}}t.Coroutine=w,n=b,w.isAlive=f,w.init=m,w.exit=v,w.terminate=y,w.port=b;class S{constructor(e){this.opts=e,this.settings=(0,o.ObjectAssign)({run:!0,delay:!0,capacity:-1,interval:0,resume:d.noop,trigger:void 0},this.opts),this.isAlive=!0,this.reception=0,this.sendBuffer=this.settings.capacity>=0?new l.Channel(this.settings.capacity):void 0,this.recvBuffer=this.settings.capacity>=0?new l.Channel(0):new j,this.result=new u.AtomicFuture,this.result.finally((()=>{this.sendBuffer?.close((e=>{for(;e.length>0;){const[,t]=e.shift();try{t(a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Canceled.")))}catch(e){(0,p.causeAsyncException)(e)}}})),this.recvBuffer.close()}))}}class O{constructor(e){this[g]={co:e}}ask(e){const t=this[g].co[g];if(!t.isAlive)return a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Canceled."));if(t.settings.capacity<0)return a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Overflowed."));t.settings.capacity>=0&&0===t.reception&&++t.reception&&t.recvBuffer.take();const r=new u.Future;return t.sendBuffer.put([e,r.bind]),++t.reception,i.Promise.all([r,t.recvBuffer.take()]).then((([e])=>e.done?t.result.then((({value:t})=>({...e,value:t}))):{...e}))}recv(){const e=this[g].co[g];return e.isAlive?(++e.reception,i.Promise.resolve(e.recvBuffer.take()).then((t=>t.done?e.result.then((({value:e})=>({...t,value:e}))):{...t}))):a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Canceled."))}send(e){const t=this[g].co[g];if(!t.isAlive)return a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Canceled."));if(t.settings.capacity<0)return a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Overflowed."));t.settings.capacity>=0&&0===t.reception&&++t.reception&&t.recvBuffer.take();const r=new u.Future;return i.Promise.resolve(t.sendBuffer.put([e,r.bind]))}connect(e){const t=this[g].co[g];return t.isAlive?(async()=>{t.settings.capacity>=0&&0===t.reception&&++t.reception&&t.recvBuffer.take();const r=e.call(this[g].co);let n;for(;;){const e=await r.next(n);if(e.done)return e.value;n=(await this.ask(e.value)).value}})():a.AtomicPromise.reject(new i.Error("Spica: Coroutine: Canceled."))}}t.isCoroutine=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.constructor&&"symbol"==typeof e.constructor.isAlive&&"boolean"==typeof e[e.constructor.isAlive]&&"symbol"==typeof e.constructor.init&&"function"==typeof e[e.constructor.init]&&"symbol"==typeof e.constructor.exit&&"function"==typeof e[e.constructor.exit]&&"symbol"==typeof e.constructor.terminate&&"function"==typeof e[e.constructor.terminate]&&"symbol"==typeof e.constructor.port&&"object"==typeof e[e.constructor.port]};class j{constructor(){this[s]=new j.Internal}get isAlive(){return this[g].isAlive}close(e){if(!this.isAlive)return;const t=this[g],{consumers:r}=t;t.isAlive=!1;for(let e=0;r[e];++e)r[e]?.bind(j.fail());r.splice(0,r.length),e&&e([])}put(e){if(!this.isAlive)return j.fail();const{consumers:t}=this[g];for(;t.length>0;)t.shift().bind(e);return a.AtomicPromise.resolve()}take(){if(!this.isAlive)return j.fail();const{consumers:e}=this[g];return e[e.push(new u.AtomicFuture)-1].then()}}s=g,function(e){e.fail=()=>a.AtomicPromise.reject(new i.Error("Spica: Channel: Closed."));e.Internal=class{constructor(){this.isAlive=!0,this.consumers=[]}}}(j||(j={}))},4877:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uncurry=t.curry=void 0;const n=r(8112);function s(e,t,...r){let n;return r.length<t?(...i)=>s(n??=r.length&&e.bind(void 0,...r)||e,t-r.length,...i):e(...r)}t.curry=e=>s(e,e.length);function i(e){const t=e.length;return(...r)=>0===t||r.length<=t?e(...r):i(e(...(0,n.shift)(r,t)[0]))(...r)}t.uncurry=e=>i(e)},8555:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(14),t)},7822:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.causeAsyncException=void 0;const n=r(4128);t.causeAsyncException=function(e){n.Promise.reject(e)}},2239:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flip=void 0,t.flip=function(e){return e.length>1?(t,r)=>e(r,t):(t,...r)=>0===r.length?r=>e(r)(t):e(r[0])(t)}},6288:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.noop=t.id=t.clear=t.singleton=void 0,t.singleton=function(e){let t;return function(...r){return t||(t=[e.call(this,...r)]),t[0]}},t.clear=function(e){return(...t)=>{e(...t)}},t.id=function(e){return e},t.noop=function(){}},3387:(e,t,r)=>{"use strict";var n,s,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.AtomicFuture=t.Future=void 0;const c=r(4128),a=r(4879);class u{constructor(e=!0){this[n]="Promise",this[s]=new a.Internal,this.bind=t=>{const r=this[a.internal];if(!r.isPending&&!e)return this;if(!r.isPending)throw new Error("Spica: Future: Cannot rebind a value.");return r.resolve(t),this}}static get[Symbol.species](){return c.Promise}then(e,t){return new c.Promise(((r,n)=>this[a.internal].then(r,n,e,t)))}catch(e){return this.then(void 0,e)}finally(e){return this.then(e,e).then((()=>this))}}t.Future=u,n=Symbol.toStringTag,s=a.internal;class l{constructor(e=!0){this[i]="Promise",this[o]=new a.Internal,this.bind=t=>{const r=this[a.internal];if(!r.isPending&&!e)return this;if(!r.isPending)throw new Error("Spica: AtomicFuture: Cannot rebind a value.");return r.resolve(t),this}}static get[Symbol.species](){return a.AtomicPromise}then(e,t){return new a.AtomicPromise(((r,n)=>this[a.internal].then(r,n,e,t)))}catch(e){return this.then(void 0,e)}finally(e){return this.then(e,e).then((()=>this))}}t.AtomicFuture=l,i=Symbol.toStringTag,o=a.internal},4128:(e,t,r)=>{"use strict";r(6921);const n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||Function("return this")();n.global=n,e.exports=n},6921:()=>{"use strict"},2269:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compose=void 0,t.compose=function(e,...t){return t.reduce(((e,t)=>(Object.getOwnPropertyNames(t.prototype).filter((t=>!(t in e.prototype))).forEach((r=>e.prototype[r]=t.prototype[r])),Object.getOwnPropertyNames(t).filter((t=>!(t in e))).forEach((r=>e[r]=t[r])),e)),e)}},7536:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(2598),t)},7452:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(2310),t)},5704:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(3766),t)},2598:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HList=void 0;const n=r(8112);t.HList=function(...e){return e.reduceRight(((e,t)=>e.add(t)),s)};const s=new class{add(e){return new i(e,this)}reverse(){return[]}tuple(){return[]}};class i{constructor(e,t){this.head=e,this.tail=t}add(e){return new i(e,this)}modify(e){return this.tail.add(e(this.head))}fold(e){return this.tail.modify((t=>e(this.head,t)))}unfold(e){return this.add(e(this.head))}reverse(){return this.tuple().reverse()}tuple(){return(0,n.unshift)([this.head],this.tail.tuple())}}},2310:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0;const n=void 0,s=Symbol("length");class i{constructor(){this[r]=0,this.head=n}get length(){return this[s]}get tail(){return this.head?.next}get last(){return this.head?.prev}clear(){this.head=n,this[s]=0}unshift(e){return this.head=this.push(e)}unshiftNode(e){return this.head=this.pushNode(e)}unshiftRotationally(e){const t=this.last;return t?(t.value=e,this.head=t,t):this.unshift(e)}shift(){return this.head?.delete()}push(e){return new o(e,this.head,this.head?.prev,this)}pushNode(e){return this.insert(e,this.head)}pushRotationally(e){const t=this.head;return t?(t.value=e,this.head=t.next,t):this.push(e)}pop(){return this.last?.delete()}insert(e,t=this.head){if(e.list===this)return t&&e.move(t),e;e.delete(),++this[s],this.head??=e,e.list=this;const r=e.next=t??e,n=e.prev=r.prev??e;return r.prev=n.next=e,e}*[(r=s,Symbol.iterator)](){for(let e=this.head;e;)if(yield e.value,e=e.next,e===this.head)return}}t.List=i;class o{constructor(e,t,r,n=t?.list??new i){this.value=e,this.next=t,this.prev=r,this.list=n,++n[s],n.head??=this,t&&r?t.prev=r.next=this:this.next=this.prev=this}delete(){return this.list?(--this.list[s],this.list.head===this&&(this.list.head=this.next===this?n:this.next),this.next&&(this.next.prev=this.prev),this.prev&&(this.prev.next=this.next),this.list=n,this.next=this.prev=n,this.value):this.value}insertBefore(e){return new o(e,this,this.prev,this.list)}insertAfter(e){return new o(e,this.next,this,this.list)}move(e){if(!e)return!1;if(this===e)return!1;if(e.list!==this.list)return e.list.insert(this,e),!0;const t=this,r=e;if(!r)return!1;if(t.next===r)return!1;const n=r.prev,s=t.prev,i=t.next;return n.next=t,t.next=r,r.prev=t,t.prev=n,s.next=i,i.prev=s,!0}moveToHead(){this.move(this.list.head),this.list.head=this}moveToLast(){this.move(this.list.head)}swap(e){const t=this,r=e;if(t===r)return!1;const n=r.next;if(t.list!==r.list)throw new Error("Spica: InvList: Cannot swap nodes across lists.");switch(r.move(t),t.move(n),this.list.head){case t:this.list.head=r;break;case r:this.list.head=t}return!0}}},3766:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.List=void 0;const n=r(4128),s=r(5406),i=r(5352),o=r(5529),c=void 0,a=1e9;class u{constructor(e=n.Infinity,t){this.heap=new i.Stack,this.HEAD=0,this.CURSOR=0,this.LENGTH=0,"object"==typeof e&&(t=e,e=n.Infinity),this.capacity=e,this.index=t,this.nodes=this.capacity<=a?(0,n.Array)((0,s.min)(this.capacity,a)):{}}get length(){return this.LENGTH}get head(){return this.nodes[this.HEAD]}get tail(){const e=this.head;return e&&this.nodes[e.next]}get last(){const e=this.head;return e&&this.nodes[e.prev]}node(e){return 0<=e&&e<this.capacity?this.nodes[e]:c}rotateToNext(){return this.HEAD=this.tail?.index??this.HEAD}rotateToPrev(){return this.HEAD=this.last?.index??this.HEAD}clear(){this.nodes=this.capacity<=a?(0,n.Array)((0,s.min)(this.capacity,a)):{},this.heap.clear(),this.index?.clear(),this.HEAD=0,this.CURSOR=0,this.LENGTH=0}add(e,t){this.LENGTH===a&&"length"in this.nodes&&(this.nodes={...this.nodes});const r=this.nodes,n=r[this.HEAD];if(!n){const n=this.HEAD=this.CURSOR=this.heap.length>0?this.heap.pop():this.length;return++this.LENGTH,this.index?.set(e,n),r[n]={index:n,key:e,value:t,next:n,prev:n},n}if(this.length!==this.capacity){const s=this.HEAD=this.CURSOR=this.heap.length>0?this.heap.pop():this.length;return++this.LENGTH,this.index?.set(e,s),r[s]={index:s,key:e,value:t,next:n.index,prev:n.prev},n.prev=r[n.prev].next=s,s}{const s=r[n.prev],i=this.HEAD=this.CURSOR=s.index;return this.index&&!(0,o.equal)(s.key,e)&&(this.index.delete(s.key,i),this.index.set(e,i)),s.key=e,s.value=t,i}}put(e,t,r){const n=this.find(e,r);return n?(n.value=t,n.index):this.add(e,t)}find(e,t=this.CURSOR){let r;if(r=this.node(t),r&&(0,o.equal)(r.key,e))return this.CURSOR=t,r;if(!this.index)throw new Error("Spica: IxList: Need the index but not given.");return(r?1!==this.length:0!==this.length)?(r=this.node(t=this.index.get(e)??-1),r?(this.CURSOR=t,r):void 0):void 0}get(e){return this.node(e)}has(e){return this.node(e)!==c}del(e){const t=this.node(e);if(!t)return;--this.LENGTH,this.heap.push(t.index),this.index?.delete(t.key,t.index);const r=this.nodes;return r[t.prev].next=t.next,r[t.next].prev=t.prev,this.HEAD===t.index&&(this.HEAD=t.next),this.CURSOR===t.index&&(this.CURSOR=t.next),r[t.index]=c,t}delete(e,t){return this.del(this.find(e,t)?.index??-1)}insert(e,t,r){const n=this.HEAD;this.HEAD=r;const s=this.add(e,t);return 1!==this.length&&(this.HEAD=n),s}unshift(e,t){return this.add(e,t)}unshiftRotationally(e,t){if(0===this.length)return this.unshift(e,t);const r=this.last;return this.index&&!(0,o.equal)(r.key,e)&&(this.index.delete(r.key,r.index),this.index.set(e,r.index)),this.HEAD=r.index,this.CURSOR=r.index,r.key=e,r.value=t,r.index}shift(){const e=this.head;return e&&this.del(e.index)}push(e,t){return this.insert(e,t,this.HEAD)}pushRotationally(e,t){if(0===this.length)return this.push(e,t);const r=this.head;return this.index&&!(0,o.equal)(r.key,e)&&(this.index.delete(r.key,r.index),this.index.set(e,r.index)),this.HEAD=r.next,this.CURSOR=r.index,r.key=e,r.value=t,r.index}pop(){const e=this.last;return e&&this.del(e.index)}replace(e,t,r){const n=this.node(e);if(!n)return;this.index&&!(0,o.equal)(n.key,t)&&(this.index.delete(n.key,e),this.index.set(t,e));const s={index:n.index,key:n.key,value:n.value,next:n.next,prev:n.prev};return n.key=t,n.value=r,s}move(e,t){if(e===t)return!1;const r=this.node(e);if(!r)return!1;const n=this.node(t);if(!n)return!1;if(r.next===n.index)return!1;const s=this.nodes,i=s[n.prev],o=s[r.prev],c=s[r.next];return i.next=r.index,r.next=n.index,n.prev=r.index,r.prev=i.index,o.next=c.index,c.prev=o.index,!0}moveToHead(e){this.move(e,this.HEAD),this.HEAD=e}moveToLast(e){this.move(e,this.HEAD),this.HEAD=e===this.HEAD?this.head.next:this.HEAD}swap(e,t){if(e===t)return!1;const r=this.node(e);if(!r)return!1;const n=this.node(t);if(!n)return!1;const s=this.nodes[n.next];switch(this.move(n.index,r.index),this.move(r.index,s.index),this.HEAD){case r.index:this.HEAD=n.index;break;case n.index:this.HEAD=r.index}return!0}*[Symbol.iterator](){const e=this.nodes;for(let t=e[this.HEAD];t;)if(yield[t.key,t.value],t=e[t.next],t?.index===this.HEAD)return}}t.List=u},6512:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(1869),t)},1808:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduce=t.memoize=void 0;const n=r(4128),s=r(5406),i=r(5529);t.memoize=function e(t,r=((...e)=>e[0]),i){if("object"==typeof r)return e(t,void 0,r);if(void 0===i)return e(t,r,new n.Map);if((0,s.isArray)(i))return e(t,r,{has:e=>void 0!==i[e],get:e=>i[e],set(e,t){return i[e]=t,this},delete(){throw 0}});let o=!1;return(...e)=>{const n=r(...e);let s=i.get(n);return void 0!==s||o&&i.has(n)||(s=t(...e),o||=void 0===s,i.set(n,s)),s}},t.reduce=function(e,t=((...e)=>e[0])){let r=[],n=[];return(...s)=>{const o=t(...s);return(0,i.equal)(r,o)||(r=o,n=e(...s)),n}}},9983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Applicative=void 0;const n=r(8946),s=r(4877);class i extends n.Functor{}t.Applicative=i,function(e){e.ap=function e(t,r){return r?t.bind((e=>r.fmap((0,s.curry)(e)))):r=>e(t,r)}}(i=t.Applicative||(t.Applicative={}))},8554:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Right=t.Left=t.Either=void 0;const n=r(7991),s=r(4879),i=r(6288);class o extends n.Monad{constructor(e){super(e)}fmap(e){return this.bind((t=>new a(e(t))))}ap(e){return o.ap(this,e)}bind(e){return new o((()=>{const t=this.evaluate();if(t instanceof c)return t;if(t instanceof a)return e(t.extract());if(t instanceof o)return t.bind(e);throw new TypeError(`Spica: Either: Invalid monad value: ${t}`)}))}join(){return this.bind((e=>e))}extract(e,t){return t?this.fmap(t).extract(e):this.evaluate().extract(e)}static do(e){const t=e();let r;for(;;){const{value:e,done:n}=t.next(r);if(n)return e;const s=e.extract(i.noop,(e=>[e]));if(!s)return e;r=s[0]}}}t.Either=o,function(e){function t(e){return new a(e)}e.pure=t,e.Return=t,e.sequence=function(t){return t instanceof e?t.extract((e=>s.AtomicPromise.resolve(new c(e))),(t=>s.AtomicPromise.resolve(t).then(e.Return))):t.reduce(((e,t)=>e.bind((e=>t.fmap((t=>[...e,t]))))),e.Return([]))}}(o=t.Either||(t.Either={}));class c extends o{constructor(e){super(u),this.value=e}bind(e){return this}extract(e){if(!e)throw this.value;return e(this.value)}}t.Left=c;class a extends o{constructor(e){super(u),this.value=e}bind(e){return new o((()=>e(this.extract())))}extract(e,t){return t?t(this.value):this.value}}function u(){throw new Error("Spica: Either: Invalid thunk call.")}t.Right=a},14:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Right=t.Left=t.Either=void 0;const o=i(r(8554)),c=r(6288);class a extends o.Either{constructor(){super(c.noop)}}t.Either=a,t.Left=function(e){return new o.Left(e)},t.Right=function(e){return new o.Right(e)}},8946:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Functor=void 0;const n=r(7395);class s extends n.Lazy{}t.Functor=s,function(e){e.fmap=function(e,t){return t?e.fmap(t):t=>e.fmap(t)}}(s=t.Functor||(t.Functor={}))},7395:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Lazy=void 0;t.Lazy=class{constructor(e){this.thunk=e,this.$memory=void 0}evaluate(){return this.$memory??=this.thunk()}}},1605:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Nothing=t.Just=t.Maybe=void 0;const n=r(4716),s=r(4879),i=r(6288);class o extends n.MonadPlus{constructor(e){super(e)}fmap(e){return this.bind((t=>new c(e(t))))}ap(e){return o.ap(this,e)}bind(e){return new o((()=>{const t=this.evaluate();if(t instanceof c)return e(t.extract());if(t instanceof a)return t;if(t instanceof o)return t.bind(e);throw new TypeError(`Spica: Maybe: Invalid monad value: ${t}`)}))}guard(e){return e?this:o.mzero}join(){return this.bind((e=>e))}extract(e,t){return t?this.fmap(t).extract(e):this.evaluate().extract(e)}static do(e){const t=e();let r;for(;;){const{value:e,done:n}=t.next(r);if(n)return e;const s=e.extract(i.noop,(e=>[e]));if(!s)return e;r=s[0]}}}t.Maybe=o,function(e){function t(e){return new c(e)}e.pure=t,e.Return=t,e.sequence=function(t){return t instanceof e?t.extract((()=>s.AtomicPromise.resolve(e.mzero)),(t=>s.AtomicPromise.resolve(t).then(e.Return))):t.reduce(((e,t)=>e.bind((e=>t.fmap((t=>[...e,t]))))),e.Return([]))}}(o=t.Maybe||(t.Maybe={}));class c extends o{constructor(e){super(u),this.value=e}bind(e){return new o((()=>e(this.extract())))}extract(e,t){return t?t(this.value):this.value}}t.Just=c;class a extends o{constructor(){super(u)}bind(e){return this}extract(e){if(!e)throw new Error("Spica: Maybe: Nothig value is extracted.");return e()}}function u(){throw new Error("Spica: Maybe: Invalid thunk call.")}t.Nothing=a,function(e){e.mzero=new a,e.mplus=function(t,r){return new e((()=>t.fmap((()=>t)).extract((()=>r))))}}(o=t.Maybe||(t.Maybe={}))},1869:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Nothing=t.Just=t.Maybe=void 0;const o=i(r(1605)),c=r(6288);class a extends o.Maybe{constructor(){super(c.noop)}}t.Maybe=a,t.Just=function(e){return new o.Just(e)},t.Nothing=o.Maybe.mzero},7991:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Monad=void 0;const n=r(9983);class s extends n.Applicative{}t.Monad=s,function(e){e.bind=function e(t,r){return r?t.bind(r):r=>e(t,r)}}(s=t.Monad||(t.Monad={}))},4716:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonadPlus=void 0;const n=r(7991);class s extends n.Monad{}t.MonadPlus=s,s=t.MonadPlus||(t.MonadPlus={})},6144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sequence=void 0,r(207),r(9035),r(323),r(6369),r(5976),r(2870),r(3571),r(3780),r(2414),r(2183),r(1755),r(1451),r(1191),r(4704),r(4655),r(1985),r(6067),r(7809),r(2881),r(7585),r(4420),r(3114),r(8501),r(9648),r(9663),r(144),r(679),r(2307),r(3337),r(9117),r(4595),r(4763),r(5645),r(1130),r(7303),r(1084),r(7899),r(2262),r(7057),r(3912),r(2061),r(8181),r(3530),r(4514),r(5666);var n=r(402);Object.defineProperty(t,"Sequence",{enumerable:!0,get:function(){return n.Sequence}})},402:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sequence=void 0;const n=r(4716);class s extends n.MonadPlus{constructor(e){super(i),this.cons=e}[Symbol.iterator](){let e=()=>this.iterate();return{next(){const t=e();return e=s.Thunk.iterator(t),{done:!s.isIterable(t),value:s.Thunk.value(t)}}}}}function i(){throw new Error("Spica: Sequence: Invalid thunk call.")}t.Sequence=s,s=t.Sequence||(t.Sequence={}),function(e){let t,r,n,s;!function(t){t.cons=function(t,r){switch(arguments.length){case 0:return[];case 1:return[t];case 2:return[t,r];default:throw e.Exception.invalidConsError(arguments)}}}(t=e.Data||(e.Data={})),function(e){e.value=function(e){return e[0]},e.iterator=function(e){return e[1]},e.index=function(e){return e[2]}}(r=e.Thunk||(e.Thunk={})),function(t){t.done=()=>[void 0,t.done,-1],t.when=function t(n,s,i){return e.isIterable(n)?i(n,(()=>t(r.iterator(n)(),s,i))):s(n)}}(n=e.Iterator||(e.Iterator={})),e.isIterable=function(e){return r.iterator(e)!==n.done},function(e){e.invalidConsError=function(e){return console.error(e,e.length,e[0],e[1]),new TypeError("Spica: Sequence: Invalid parameters of cons.")},e.invalidDataError=function(e){return console.error(e),new TypeError("Spica: Sequence: Invalid data.")},e.invalidThunkError=function(e){return console.error(e),new TypeError("Spica: Sequence: Invalid thunk.")}}(s=e.Exception||(e.Exception={}))}(s=t.Sequence||(t.Sequence={}))},4595:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{ap(e){return n.Sequence.ap(this,e)}})},4763:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{bind(e){return n.Sequence.concat(this.fmap(e))}})},8501:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{drop(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>n.Sequence.Thunk.index(t)<e?s():r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},679:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{dropUntil(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>e(n.Sequence.Thunk.value(t))?s():r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},9663:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{dropWhile(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>e(n.Sequence.Thunk.value(t))?s():r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},7809:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{extract(){const e=[];let t=()=>this.iterate();for(;;){const r=t();if(!n.Sequence.isIterable(r))return e;e.push(n.Sequence.Thunk.value(r)),t=n.Sequence.Thunk.iterator(r)}}})},7899:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{filter(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),((t,s)=>e(n.Sequence.Thunk.value(t),n.Sequence.Thunk.index(t))?r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t)):s()))))}})},7303:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{filterM(e){return n.Sequence.from([0]).bind((()=>{const t=this.extract();if(0===t.length)return n.Sequence.from([[]]);{const r=t.shift();return e(r).bind((s=>s?0===t.length?n.Sequence.from([[r]]):n.Sequence.from(t).filterM(e).fmap((e=>[r,...e])):0===t.length?n.Sequence.from([[]]):n.Sequence.from(t).filterM(e)))}}))}})},9117:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{fmap(e){return new n.Sequence(((t=(()=>this.iterate()))=>n.Sequence.Iterator.when(t(),(()=>n.Sequence.Data.cons()),(t=>n.Sequence.Data.cons(e(n.Sequence.Thunk.value(t)),n.Sequence.Thunk.iterator(t))))))}})},7057:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{foldr(e,t){return new n.Sequence(((r=(()=>this.reduce().iterate()))=>n.Sequence.Iterator.when(r(),(()=>n.Sequence.Data.cons(t)),(r=>n.Sequence.Data.cons(e(n.Sequence.Thunk.value(r),n.Sequence.resume(n.Sequence.Thunk.iterator(r)).foldr(e,t))))))).bind((e=>e))}})},3912:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{group(e){return new n.Sequence((([t,r]=[()=>this.iterate(),[]],s)=>n.Sequence.Iterator.when(t(),(()=>0===r.length?s():s(r)),((t,i)=>0===r.length||e(r[0],n.Sequence.Thunk.value(t))?(r.push(n.Sequence.Thunk.value(t)),i()):s(r,[n.Sequence.Thunk.iterator(t),[n.Sequence.Thunk.value(t)]])))))}})},2061:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{inits(){return n.Sequence.mappend(n.Sequence.from([[]]),this.scanl(((e,t)=>[...e,t]),[]).dropWhile((e=>0===e.length)))}})},2881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{iterate(){return this.iterate_()}iterate_(e,t=0){const r=this.cons(e,n.Sequence.Data.cons);switch(r.length){case 0:return[void 0,n.Sequence.Iterator.done,-1];case 1:return[r[0],()=>n.Sequence.Iterator.done(),t];case 2:return[r[0],()=>this.iterate_(r[1],t+1),t];default:throw n.Sequence.Exception.invalidDataError(r)}}})},5645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{join(){return n.Sequence.concat(this)}})},1084:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{map(e){return new n.Sequence(((t=(()=>this.iterate()))=>n.Sequence.Iterator.when(t(),(()=>n.Sequence.Data.cons()),(t=>n.Sequence.Data.cons(e(n.Sequence.Thunk.value(t),n.Sequence.Thunk.index(t)),n.Sequence.Thunk.iterator(t))))))}})},1130:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{mapM(e){return n.Sequence.from([0]).bind((()=>{const t=this.extract();if(0===t.length)return n.Sequence.mempty;{const r=t.shift();return e(r).bind((r=>0===t.length?n.Sequence.from([[r]]):n.Sequence.from(t).mapM(e).fmap((e=>[r,...e]))))}}))}})},7585:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4128),s=r(402),i=r(2269),o=(0,r(1808).memoize)((e=>new n.Map));(0,i.compose)(s.Sequence,class extends s.Sequence{memoize(){return new s.Sequence((([e,t]=[0,o(this)],r)=>s.Sequence.Iterator.when(t.get(e)||t.set(e,e>0&&t.has(e-1)?s.Sequence.Thunk.iterator(t.get(e-1))():this.iterate()).get(e),(()=>r()),(n=>r(s.Sequence.Thunk.value(n),[e+1,t])))))}})},5666:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);function s(e,t){return n.Sequence.Iterator.when(e.iterate(),(()=>n.Sequence.mempty),(e=>new n.Sequence(((r,i)=>n.Sequence.Iterator.when(e,(()=>i()),(e=>{const r=n.Sequence.Thunk.value(e),o=n.Sequence.resume(n.Sequence.Thunk.iterator(e)).memoize();return i(t.permutations().foldr(((e,t)=>function(e,t){return c((e=>e),e,t)[1]}(n.Sequence.from(e),t)),s(o,n.Sequence.mappend(n.Sequence.from([r]),t))));function c(e,t,s){return n.Sequence.Iterator.when(t.iterate(),(()=>[o,s]),(t=>{const i=n.Sequence.Thunk.value(t),[o,a]=c((t=>e(n.Sequence.mappend(n.Sequence.from([i]),t))),n.Sequence.resume(n.Sequence.Thunk.iterator(t)),s);return[n.Sequence.mappend(n.Sequence.from([i]),o),n.Sequence.mappend(n.Sequence.from([e(n.Sequence.mappend(n.Sequence.from([r]),n.Sequence.mappend(n.Sequence.from([i]),o))).extract()]),a)]}))}})))).bind((e=>e))))}(0,r(2269).compose)(n.Sequence,class extends n.Sequence{permutations(){return n.Sequence.from([0]).bind((()=>{const e=this.extract();return 0===e.length?n.Sequence.mempty:n.Sequence.from([e])})).bind((e=>n.Sequence.mappend(n.Sequence.from([e]),s(n.Sequence.from(e),n.Sequence.mempty))))}})},4420:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4128),s=r(402);(0,r(2269).compose)(s.Sequence,class extends s.Sequence{reduce(){return new s.Sequence((([e,t]=[0,new n.Map],r)=>s.Sequence.Iterator.when(t.get(e)||t.set(e,e>0&&t.has(e-1)?s.Sequence.Thunk.iterator(t.get(e-1))():this.iterate()).get(e),(()=>r()),(n=>r(s.Sequence.Thunk.value(n),[e+1,t])))))}})},2262:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{scanl(e,t){return new n.Sequence((([r,s,i]=[t,()=>this.iterate(),0])=>n.Sequence.Iterator.when(s(),(()=>0===i?n.Sequence.Data.cons(t):n.Sequence.Data.cons()),(t=>n.Sequence.Data.cons(r=e(r,n.Sequence.Thunk.value(t)),[r,n.Sequence.Thunk.iterator(t),n.Sequence.Thunk.index(t)+1])))))}})},3530:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{segs(){return n.Sequence.mappend(this.foldr(((e,t)=>t.take(1).bind((r=>n.Sequence.mappend(n.Sequence.from([n.Sequence.mappend(n.Sequence.from([[e]]),n.Sequence.from(r).map((t=>[e,...t])))]),t)))),n.Sequence.from([n.Sequence.from([])])).bind((e=>e)),n.Sequence.from([[]]))}})},2307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{sort(e){return n.Sequence.from(this.extract().sort(e))}})},4514:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);function s(e){return n.Sequence.Iterator.when(e.iterate(),(()=>n.Sequence.mempty),(e=>n.Sequence.mappend(n.Sequence.from([[n.Sequence.Thunk.value(e)]]),new n.Sequence(((t,r)=>n.Sequence.Iterator.when(e,(()=>r()),(e=>r(s(n.Sequence.resume(n.Sequence.Thunk.iterator(e))).foldr(((t,r)=>n.Sequence.mappend(n.Sequence.mappend(n.Sequence.from([t]),n.Sequence.from([[n.Sequence.Thunk.value(e),...t]])),r)),n.Sequence.mempty)))))).bind((e=>e)))))}(0,r(2269).compose)(n.Sequence,class extends n.Sequence{subsequences(){return n.Sequence.mappend(n.Sequence.from([[]]),n.Sequence.from([0]).bind((()=>s(this))))}})},8181:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{tails(){return n.Sequence.mappend(n.Sequence.from(this.extract().map(((e,t,r)=>r.slice(t)))),n.Sequence.from([[]]))}})},3114:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{take(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(e>0?t():n.Sequence.Iterator.done(),(()=>r()),(t=>n.Sequence.Thunk.index(t)+1<e?r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t)):r(n.Sequence.Thunk.value(t))))))}})},144:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{takeUntil(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),(t=>e(n.Sequence.Thunk.value(t))?r(n.Sequence.Thunk.value(t)):r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t))))))}})},9648:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{takeWhile(e){return new n.Sequence(((t=(()=>this.iterate()),r)=>n.Sequence.Iterator.when(t(),(()=>r()),(t=>e(n.Sequence.Thunk.value(t))?r(n.Sequence.Thunk.value(t),n.Sequence.Thunk.iterator(t)):r()))))}})},3337:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{unique(){const e=new Set;return this.filter((t=>!e.has(t)&&!!e.add(t)))}})},5976:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static concat(e){return new n.Sequence((([t,r]=[()=>e.iterate(),n.Sequence.Iterator.done],s)=>n.Sequence.Iterator.when(t(),(()=>s()),((e,t)=>(r=r===n.Sequence.Iterator.done?()=>n.Sequence.Thunk.value(e).iterate():r,n.Sequence.Iterator.when(r(),(()=>(r=n.Sequence.Iterator.done,t())),(t=>s(n.Sequence.Thunk.value(t),[()=>e,n.Sequence.Thunk.iterator(t)]))))))))}})},323:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static cycle(e){return new n.Sequence((function t([r,n]=[e[Symbol.iterator](),0],s){const i=r.next();return i.done?t([e[Symbol.iterator](),n+1],s):s(i.value,[r,n+1])})).reduce()}})},3571:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static difference(e,t,r){return new n.Sequence((([s,i]=[()=>e.iterate(),()=>t.iterate()],o)=>n.Sequence.Iterator.when(s(),(()=>n.Sequence.Iterator.when(i(),(()=>o()),(e=>o(n.Sequence.Thunk.value(e),[n.Sequence.Iterator.done,n.Sequence.Thunk.iterator(e)])))),((e,t)=>n.Sequence.Iterator.when(i(),(()=>o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Iterator.done])),(s=>{const c=r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(s));return c<0?o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),()=>s]):c>0?o(n.Sequence.Thunk.value(s),[()=>e,n.Sequence.Thunk.iterator(s)]):(i=()=>n.Sequence.Thunk.iterator(s)(),t())}))))))}})},9035:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static from(e){return new n.Sequence((([t,r]=[e[Symbol.iterator](),0],n)=>{const s=t.next();return s.done?n():n(s.value,[t,r+1])})).reduce()}})},2414:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static intersect(e,t,r){return new n.Sequence((([s,i]=[()=>e.iterate(),()=>t.iterate()],o)=>n.Sequence.Iterator.when(s(),(()=>o()),((e,t)=>n.Sequence.Iterator.when(i(),(()=>o()),((s,c)=>{const a=r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(s));return a<0?(i=()=>s,t()):a>0?c():o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Thunk.iterator(s)])}))))))}})},4655:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static mappend(e,t){return n.Sequence.mconcat([e,t])}})},4704:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static mconcat(e){return[...e].reduce(((e,t)=>function(e,t){return new n.Sequence((([r,s]=[()=>e.iterate(),()=>t.iterate()],i)=>n.Sequence.Iterator.when(r(),(()=>n.Sequence.Iterator.when(s(),(()=>i()),(e=>i(n.Sequence.Thunk.value(e),[n.Sequence.Iterator.done,n.Sequence.Thunk.iterator(e)])))),(e=>i(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),s])))))}(e,t)),n.Sequence.mempty)}})},1191:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});const s=r(402);(0,r(2269).compose)(s.Sequence,((n=class extends s.Sequence{}).mempty=new s.Sequence(((e,t)=>t())),n))},6067:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});const s=r(402);(0,r(2269).compose)(s.Sequence,((n=class extends s.Sequence{}).mplus=s.Sequence.mappend,n))},1985:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0});const s=r(402);(0,r(2269).compose)(s.Sequence,((n=class extends s.Sequence{}).mzero=s.Sequence.mempty,n))},2183:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static pure(e){return new n.Sequence(((t,r)=>r(e)))}})},6369:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5406),s=r(402);(0,r(2269).compose)(s.Sequence,class extends s.Sequence{static random(e=(()=>(0,n.random)())){return"function"==typeof e?s.Sequence.from(new s.Sequence(((t,r)=>r(e(),t)))):this.random().map((t=>e[(0,n.floor)(t*e.length)]))}})},207:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static resume(e){return new n.Sequence(((t=e,r)=>n.Sequence.Iterator.when(t(),(()=>r()),(e=>r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.iterator(e))))))}})},1755:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static Return(e){return new n.Sequence(((t,r)=>r(e)))}})},1451:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static sequence(e){return e.reduce(((e,t)=>e.fmap((e=>n.Sequence.mappend(e,t)))),n.Sequence.Return(n.Sequence.from([])))}})},3780:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static union(e,t,r){return new n.Sequence((([s,i]=[()=>e.iterate(),()=>t.iterate()],o)=>n.Sequence.Iterator.when(s(),(()=>n.Sequence.Iterator.when(i(),(()=>o()),(e=>o(n.Sequence.Thunk.value(e),[n.Sequence.Iterator.done,n.Sequence.Thunk.iterator(e)])))),(e=>n.Sequence.Iterator.when(i(),(()=>o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Iterator.done])),(t=>{const s=r(n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(t));return s<0?o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),()=>t]):s>0?o(n.Sequence.Thunk.value(t),[()=>e,n.Sequence.Thunk.iterator(t)]):o(n.Sequence.Thunk.value(e),[n.Sequence.Thunk.iterator(e),n.Sequence.Thunk.iterator(t)])}))))))}})},2870:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(402);(0,r(2269).compose)(n.Sequence,class extends n.Sequence{static zip(e,t){return new n.Sequence((([r,s]=[()=>e.iterate(),()=>t.iterate()],i)=>n.Sequence.Iterator.when(r(),(()=>i()),(e=>n.Sequence.Iterator.when(s(),(()=>i()),(t=>i([n.Sequence.Thunk.value(e),n.Sequence.Thunk.value(t)],[n.Sequence.Thunk.iterator(e),n.Sequence.Thunk.iterator(t)])))))))}})},4615:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Observation=void 0;const n=r(4128),s=r(5406),i=r(5704),o=r(6288),c=r(8112),a=r(7822);class u{constructor(e,t){this.parent=e,this.index=t,this.children=new i.List(new n.Map),this.monitors=[],this.subscribers=[]}}function l({monitors:e,subscribers:t,children:r}){for(let e=r.last,t=0;e&&t<r.length;(e=r.node(e.prev))&&++t)if(l(e.value)){if(e=r.node(r.del(e.index).next),!e)break;--t}return(0,c.splice)(t,0),0===e.length}t.Observation=class{constructor(e={}){this.id=0,this.node=new u(void 0,void 0),this.settings={limit:10,cleanup:!1},this.relaies=new n.WeakSet,(0,s.ObjectAssign)(this.settings,e)}monitor(e,t,r={}){if("function"!=typeof t)throw new n.Error(`Spica: Observation: Invalid listener: ${t}`);const{monitors:s}=this.seekNode(e,0);if(s.length===this.settings.limit)throw new n.Error("Spica: Observation: Exceeded max listener limit.");if(this.id===n.Number.MAX_SAFE_INTEGER)throw new n.Error("Spica: Observation: Max listener ID reached max safe integer.");const i={id:++this.id,type:0,namespace:e,listener:t,options:r};return s.push(i),(0,o.singleton)((()=>{this.off(e,i)}))}on(e,t,r={}){if("function"!=typeof t)throw new n.Error(`Spica: Observation: Invalid listener: ${t}`);const{subscribers:s}=this.seekNode(e,0);if(s.length===this.settings.limit)throw new n.Error("Spica: Observation: Exceeded max listener limit.");if(this.id===n.Number.MAX_SAFE_INTEGER)throw new n.Error("Spica: Observation: Max listener ID reached max safe integer.");const i={id:++this.id,type:1,namespace:e,listener:t,options:r};return s.push(i),(0,o.singleton)((()=>{this.off(e,i)}))}once(e,t){return this.on(e,t,{once:!0})}off(e,t){const r=this.seekNode(e,1);if(r)switch(typeof t){case"object":{const e=0===t.type?r.monitors:r.subscribers;if(0===e.length||t.id<e[0].id||t.id>e[e.length-1].id)return;return void(0,c.splice)(e,e.indexOf(t),1)}case"function":{const e=r.subscribers;return void(0,c.splice)(e,e.findIndex((e=>e.listener===t)),1)}case"undefined":return void l(r)}}emit(e,t,r){this.drain(e,t,r)}reflect(e,t){let r;return this.emit(e,t,((e,t)=>r=t)),r}relay(e){if(this.relaies.has(e))throw new n.Error("Spica: Observation: Relay source is already registered.");return this.relaies.add(e),e.monitor([],((e,t)=>{this.emit(t,e)}))}refs(e){const t=this.seekNode(e,1);return t?(0,c.push)(this.refsBelow(t,0),this.refsBelow(t,1)).reduce(((e,t)=>(0,c.push)(e,t)),[]):[]}drain(e,t,r){const n=this.seekNode(e,1),s=[],i=n?this.refsBelow(n,1):[];for(let n=0;n<i.length;++n){const o=i[n];if(0!==o.length)for(let n=0,i=o[o.length-1].id;n<o.length&&o[n].id<=i;++n){const i=o[n];i.options.once&&this.off(i.namespace,i);try{const n=i.listener(t,e);r&&s.push(n)}catch(e){(0,a.causeAsyncException)(e)}for(n=n<o.length?n:o.length-1;n>=0&&o[n].id>i.id;--n);}}const o=this.refsAbove(n||this.seekNode(e,2),0);for(let r=0;r<o.length;++r){const n=o[r];if(0!==n.length)for(let r=0,s=n[n.length-1].id;r<n.length&&n[r].id<=s;++r){const s=n[r];s.options.once&&this.off(s.namespace,s);try{s.listener(t,e)}catch(e){(0,a.causeAsyncException)(e)}for(r=r<n.length?r:n.length-1;r>=0&&n[r].id>s.id;--r);}}if(r)try{r(t,s)}catch(e){(0,a.causeAsyncException)(e)}}refsAbove({parent:e,monitors:t,subscribers:r},n){const s=0===n?[t]:[r];for(;e;)0===n?s.push(e.monitors):s.push(e.subscribers),e=e.parent;return s}refsBelow(e,t){return this.refsBelow_(e,t,[])[0]}refsBelow_({monitors:e,subscribers:t,children:r},n,s){0===n?s.push(e):s.push(t);let i=0;for(let e=r.last,t=0;e&&t<r.length;(e=r.node(e.prev))&&++t){const o=this.refsBelow_(e.value,n,s)[1];if(i+=o,0===o&&this.settings.cleanup){if(e=r.node(r.del(e.index).next),!e)break;--t}}return[s,e.length+t.length+i]}seekNode(e,t){let r=this.node;for(let n=0;n<e.length;++n){const s=e[n],{children:i}=r;let o=i.find(s)?.value;if(!o){switch(t){case 1:return;case 2:return r}o=new u(r,s),i.add(s,o)}r=o}return r}}},4879:(e,t,r)=>{"use strict";var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.never=t.isPromiseLike=t.Internal=t.AtomicPromise=t.internal=void 0;const i=r(4128),o=r(5406),c=r(6288);t.internal=Symbol.for("spica/promise::internal");class a{constructor(e){this[n]="Promise",this[s]=new u;try{e((e=>{this[t.internal].resolve(e)}),(e=>{this[t.internal].reject(e)}))}catch(e){this[t.internal].reject(e)}}static get[Symbol.species](){return a}static all(e){return new a(((r,n)=>{const s=(0,o.isArray)(e)?e:[...e],c=(0,i.Array)(s.length);let a=!1,u=0;for(let e=0;!a&&e<s.length;++e){const i=s[e];if(d(i)){if(p(i)){const{status:r}=i[t.internal];switch(r.state){case 2:c[e]=r.value,++u;continue;case 3:return n(r.reason)}}i.then((t=>{c[e]=t,++u,u===s.length&&r(c)}),(e=>{n(e),a=!0}))}else c[e]=i,++u}u===s.length&&r(c)}))}static race(e){return new a(((r,n)=>{const s=(0,o.isArray)(e)?e:[...e];for(let e=0;e<s.length;++e){const i=s[e];if(!d(i))return r(i);if(p(i)){const{status:e}=i[t.internal];switch(e.state){case 2:return r(e.value);case 3:return n(e.reason)}}}let i=!1;for(let e=0;!i&&e<s.length;++e){s[e].then((e=>{r(e),i=!0}),(e=>{n(e),i=!0}))}}))}static allSettled(e){return new a((r=>{const n=(0,o.isArray)(e)?e:[...e],s=(0,i.Array)(n.length);let c=0;for(let e=0;e<n.length;++e){const i=n[e];if(d(i)){if(p(i)){const{status:r}=i[t.internal];switch(r.state){case 2:s[e]={status:"fulfilled",value:r.value},++c;continue;case 3:s[e]={status:"rejected",reason:r.reason},++c;continue}}i.then((t=>{s[e]={status:"fulfilled",value:t},++c,c===n.length&&r(s)}),(t=>{s[e]={status:"rejected",reason:t},++c,c===n.length&&r(s)}))}else s[e]={status:"fulfilled",value:i},++c}c===n.length&&r(s)}))}static any(e){return new a(((r,n)=>{const s=(0,o.isArray)(e)?e:[...e],c=(0,i.Array)(s.length);let a=!1,u=0;for(let e=0;!a&&e<s.length;++e){const i=s[e];if(!d(i))return r(i);if(p(i)){const{status:n}=i[t.internal];switch(n.state){case 2:return r(n.value);case 3:c[e]=n.reason,++u;continue}}i.then((e=>{r(e),a=!0}),(t=>{c[e]=t,++u,u===s.length&&n(new AggregateError(c,"All promises were rejected"))}))}u===s.length&&n(new AggregateError(c,"All promises were rejected"))}))}static resolve(e){return new a((t=>t(e)))}static reject(e){return new a(((t,r)=>r(e)))}then(e,r){return new a(((n,s)=>this[t.internal].then(n,s,e,r)))}catch(e){return this.then(void 0,e)}finally(e){return this.then(e,e).then((()=>this))}}t.AtomicPromise=a,n=Symbol.toStringTag,s=t.internal;class u{constructor(){this.status={state:0},this.fulfillReactions=[],this.rejectReactions=[]}get isPending(){return 0===this.status.state}resolve(e){if(0===this.status.state){if(!d(e))return this.status={state:2,value:e},this.resume();if(p(e)){const r=e[t.internal];switch(r.status.state){case 2:case 3:return this.status=r.status,this.resume();default:return r.then((()=>(this.status=r.status,this.resume())),(()=>(this.status=r.status,this.resume())))}}this.status={state:1,promise:e},e.then((e=>{this.status={state:2,value:e},this.resume()}),(e=>{this.status={state:3,reason:e},this.resume()}))}}reject(e){if(0===this.status.state)return this.status={state:3,reason:e},this.resume()}then(e,t,r,n){const{status:s,fulfillReactions:i,rejectReactions:o}=this;switch(s.state){case 2:if(0!==i.length)break;return h(e,t,e,r,s.value);case 3:if(0!==o.length)break;return h(e,t,t,n,s.reason)}i.push([e,t,e,r]),o.push([e,t,t,n])}resume(){const{status:e,fulfillReactions:t,rejectReactions:r}=this;switch(e.state){case 0:case 1:return;case 2:if(0!==r.length&&(this.rejectReactions=[]),0===t.length)return;return l(t,e.value),void(this.fulfillReactions=[]);case 3:if(0!==t.length&&(this.fulfillReactions=[]),0===r.length)return;return l(r,e.reason),void(this.rejectReactions=[])}}}function l(e,t){for(let r=0;r<e.length;++r){const n=e[r];h(n[0],n[1],n[2],n[3],t)}}function h(e,t,r,n,s){if(!n)return r(s);try{e(n(s))}catch(e){t(e)}}function d(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}function p(e){return t.internal in e}t.Internal=u,t.isPromiseLike=d,t.never=new class e extends Promise{static get[Symbol.species](){return e}constructor(){super(c.noop)}then(){return this}catch(){return this}finally(){return this}}},4198:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.router=void 0;const n=r(4128),s=r(5406),i=r(2261),o=r(8715),c=r(4877),a=r(2239),u=r(1808),l=r(9210);function h(e){const{compare:t}=h.helpers();return r=>{const{path:u,pathname:l}=new i.URL((0,i.standardize)(r,n.global.location.href));return o.Sequence.from((0,s.ObjectKeys)(e).filter((e=>"/"===e[0])).sort().reverse()).filter((0,c.curry)((0,a.flip)(t))(l)).map((t=>e[t])).take(1).extract().pop().call(e,u)}}function d(e){const t=e.replace(/\*(\?+)\*?/g,"$1*");return t===e?t:d(t)}t.router=h,function(e){e.helpers=function(){function e(e,r){return("."!==r[0]||!["?","*"].includes(e[0]))&&t(d(e),r)}const t=(0,u.memoize)(((e,r)=>{const[n="",...s]=[...e],[i="",...c]=[...r];switch(n){case"":return""===i;case"?":return""!==i&&"/"!==i&&t(s.join(""),c.join(""));case"*":return"/"===i?t(s.join(""),r):o.Sequence.zip(o.Sequence.cycle([s.join("")]),o.Sequence.from(r).tails().map((e=>e.join("")))).filter((([e,r])=>t(e,r))).take(1).extract().length>0;default:return i===n&&t(s.join(""),c.join(""))}}),((e,t)=>`${e}\n${t}`),new l.Cache(1e4));function r(e){if(e.match(/\*\*|[\[\]]/))throw new Error(`Invalid pattern: ${e}`);return n(e)}const n=(0,u.memoize)((e=>""===e?[e]:o.Sequence.from(e.match(/{[^{}]*}|.[^{]*/g)).map((e=>e.match(/^{[^{}]*}$/)?e.slice(1,-1).split(","):[e])).mapM(o.Sequence.from).map((e=>e.join(""))).bind((t=>t===e?o.Sequence.from([t]):o.Sequence.from(n(t)))).unique().extract()));return{compare:function(t,n){const s=/\/|[^/]+\/?/g,i=/\/$/;return o.Sequence.zip(o.Sequence.from(r(t)),o.Sequence.cycle([n])).map((([e,t])=>[e.match(s)||[],e.match(i)?t.match(s)||[]:t.replace(i,"").match(s)||[]])).filter((([t,r])=>t.length<=r.length&&0===o.Sequence.zip(o.Sequence.from(t),o.Sequence.from(r)).dropWhile((([t,r])=>e(t,r))).take(1).extract().length)).take(1).extract().length>0},match:e,expand:r}}}(h=t.router||(t.router={}))},8715:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(6144),t)},5352:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stack=void 0;const r=void 0;class n{constructor(){this.list=r,this.length=0}push(e){const t=this.list,r=t?.[0];++this.length,r&&100!==r.length?r.push(e):this.list=[[e],t]}pop(){const e=this.list;if(e===r)return;const t=e[0];if(--this.length,1!==t.length)return t.pop();const n=t[0];return this.list=e[1],e[1]=r,n}clear(){this.list=r}isEmpty(){return this.list===r}peek(){return this.list?.[0][0]}*[Symbol.iterator](){for(;!this.isEmpty();)yield this.pop()}}t.Stack=n},7780:(e,t,r)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.Supervisor=void 0;const s=r(4128),i=r(5406),o=r(7681),c=r(7983),a=r(4879),u=r(3387),l=r(4615),h=r(6288),d=r(8112),p=r(7822);class f extends c.Coroutine{constructor(e={}){if(super((async function*(){return this.state}),{delay:!1}),this.state=new u.AtomicFuture,this.settings={name:"",capacity:s.Infinity,timeout:s.Infinity,destructor:h.noop,scheduler:o.tick,resource:10},this.workers=new s.Map,this.isAlive=!0,this.available=!0,this[n]={ask:()=>{throw new s.Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port.`)},recv:()=>{throw new s.Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port.`)},send:()=>{throw new s.Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port.`)},connect:()=>{throw new s.Error(`Spica: Supervisor: <${this.name}>: Cannot use coroutine port.`)}},this.scheduled=!1,this.messages=[],(0,i.ObjectAssign)(this.settings,e),this.name=this.settings.name,this.constructor===f)throw new s.Error(`Spica: Supervisor: <${this.name}>: Cannot instantiate abstract classes.`);this.constructor.instances.add(this)}static get instances(){return this.hasOwnProperty("$instances")?this.$instances:this.$instances=new s.Set}static get status(){if(this.hasOwnProperty("$status"))return this.$status;const{instances:e}=this;return this.$status={get instances(){return e.size},get processes(){return[...e].reduce(((e,t)=>e+t.workers.size),0)}}}static clear(e){for(;this.instances.size>0;)for(const t of this.instances)t.terminate(e)}destructor(e){for(this.available=!1,this.clear(e),(0,i.ObjectFreeze)(this.workers);this.messages.length>0;){const[e,t,,,r]=this.messages.shift(),n=e[s.Symbol.iterator]().next().value;r&&(0,s.clearTimeout)(r),this.$events?.loss.emit([n],[n,t])}this.isAlive=!1,this.constructor.instances.delete(this),(0,i.ObjectFreeze)(this),this.settings.destructor(e),this.state.bind(void 0===e?void 0:a.AtomicPromise.reject(e))}get events(){return this.$events??={init:new l.Observation,exit:new l.Observation,loss:new l.Observation}}throwErrorIfNotAvailable(){if(!this.available)throw new s.Error(`Spica: Supervisor: <${this.name}>: Cannot use terminated supervisors.`)}register(e,t,r){if(this.throwErrorIfNotAvailable(),(0,c.isCoroutine)(t)){const n=t[t.constructor.port],s={init:e=>e,main:(e,t,r)=>n.ask(e).then((({value:e,done:n})=>n&&void r()||[e,t])),exit:e=>{t[t.constructor.terminate](e)}};this.constructor.standalone.add(s);const i=this.register(e,s,r);return t.catch(i),i}if(function(e){return"AsyncGeneratorFunction"===e[s.Symbol.toStringTag]}(t)){let n;return this.register(e,{init:(e,r)=>(n=t(e,r),n.next().catch(r),e),main:(e,t,r)=>a.AtomicPromise.resolve(n.next(e)).then((({value:e,done:n})=>n&&void r()||[e,t])),exit:h.noop},r)}if("function"==typeof t){if(function(e){return"GeneratorFunction"===e[s.Symbol.toStringTag]}(t)){let n;return this.register(e,{init:(e,r)=>(n=t(e,r),n.next(),e),main:(e,t,r)=>{const{value:s,done:i}=n.next(e);return i&&r(),[s,t]},exit:h.noop},r)}return this.register(e,{init:e=>e,main:t,exit:h.noop},r)}if(this.workers.has(e))throw new s.Error(`Spica: Supervisor: <${this.name}/${e}>: Cannot register another process with tha same name.`);this.schedule();const n=new v(e,t,r,this,(()=>{this.schedule()}),this.constructor.standalone.has(t),this.$events,(()=>{this.workers.get(e)===n&&this.workers.delete(e)}));return this.workers.set(e,n),n.terminate}call(e,t,r,n=this.settings.timeout){if("function"!=typeof r)return new a.AtomicPromise(((n,s)=>{this.call(e,t,((e,t)=>e?s(e):n(t)),r)}));for(this.throwErrorIfNotAvailable(),this.messages.push(["string"==typeof e?[e]:new m(this.workers,e),t,r,Date.now()+n,0]);this.messages.length>(this.available?this.settings.capacity:0);){const[e,t,r,,n]=this.messages.shift();n&&(0,s.clearTimeout)(n);const i=e[s.Symbol.iterator]().next().value;this.$events?.loss.emit([i],[i,t]);try{r(new s.Error(`Spica: Supervisor: <${this.name}>: Message overflowed.`),void 0)}catch(e){(0,p.causeAsyncException)(e)}}0!==this.messages.length&&(this.throwErrorIfNotAvailable(),this.schedule(),n>0&&n!==s.Infinity&&(this.messages[this.messages.length-1][4]=(0,s.setTimeout)((()=>{this.schedule()}),n+3)))}cast(e,t,r=this.settings.timeout){this.throwErrorIfNotAvailable();const n=Date.now()+r;let s;for(e of"string"==typeof e?[e]:new m(this.workers,e))if(s=this.workers.get(e)?.call([t,n]))break;if(s)return s;const i="string"==typeof e?e:void 0;this.$events?.loss.emit([i],[i,t])}refs(e){return void 0===e?[...this.workers.values()].map(t):this.workers.has(e)?[t(this.workers.get(e))]:[];function t(e){return[e.name,e.process,e.state,e.terminate]}}kill(e,t){return!!this.available&&(!!this.workers.has(e)&&this.workers.get(e).terminate(t))}clear(e){for(;this.workers.size>0;)for(const t of this.workers.values())t.terminate(e)}terminate(e){return!!this.available&&(this.destructor(e),this[c.Coroutine.exit](void 0),!0)}[c.Coroutine.terminate](e){this.terminate(e)}schedule(){if(!this.available||this.scheduled||0===this.messages.length)return;this.scheduled=!0;const e=new u.AtomicFuture(!1);e.finally((()=>{this.scheduled=!1,this.deliver()})),this.settings.scheduler.call(void 0,e.bind),this.settings.scheduler===s.global.requestAnimationFrame&&(0,s.setTimeout)(e.bind,1e3)}deliver(){if(!this.available)return;const e=Date.now();for(let t=0,r=this.messages.length;this.available&&t<r;++t){if(this.settings.resource-(Date.now()-e)<=0)return void this.schedule();const[n,i,o,c,a]=this.messages[t];let u,l;for(l of"string"==typeof n?[n]:n){if(Date.now()>c)break;if(u=this.workers.get(l)?.call([i,c]))break}if(u||!(Date.now()<c))if((0,d.splice)(this.messages,t,1),--t,--r,a&&(0,s.clearTimeout)(a),u)u.then((e=>{o(void 0,e)}),(()=>{o(new s.Error(`Spica: Supervisor: <${this.name}>: Process failed.`),void 0)}));else{this.$events?.loss.emit([l],[l,i]);try{o(new s.Error(`Spica: Supervisor: <${this.name}>: Message expired.`),void 0)}catch(e){(0,p.causeAsyncException)(e)}}}}}t.Supervisor=f,n=c.Coroutine.port,f.standalone=new s.WeakSet;class m{constructor(e,t){this.workers=e,this.selector=t}[s.Symbol.iterator](){return this.selector(this.workers.keys())[s.Symbol.iterator]()}}class v{constructor(e,t,r,n,s,i,o,c){this.name=e,this.process=t,this.state=r,this.sv=n,this.schedule=s,this.events=o,this.destructor_=c,this.isAlive=!0,this.available=!0,this.initiated=!1,this.terminate=e=>!!this.isAlive&&(this.destructor(e),!0),i&&this.init()}destructor(e){this.isAlive=!1,this.available=!1,(0,i.ObjectFreeze)(this);try{this.destructor_()}catch(e){(0,p.causeAsyncException)(e)}this.initiated&&this.exit(e)}init(){this.initiated=!0,this.events?.init.emit([this.name],[this.name,this.process,this.state]),this.state=this.process.init(this.state,this.terminate)}exit(e){try{this.process.exit(e,this.state),this.events?.exit.emit([this.name],[this.name,this.process,this.state,e])}catch(t){this.events?.exit.emit([this.name],[this.name,this.process,this.state,e]),this.sv.terminate(t)}}call([e,t]){if(this.available)return new a.AtomicPromise(((r,n)=>{(0,i.isFinite)(t)&&(0,s.setTimeout)((()=>{n(new s.Error)}),t-Date.now()),this.available=!1,this.initiated||(this.init(),this.isAlive)?a.AtomicPromise.resolve(this.process.main(e,this.state,this.terminate)).then(r,n):n()})).then((([e,t])=>(this.isAlive&&(this.schedule(),this.state=t,this.available=!0),e))).catch((e=>{throw this.schedule(),this.terminate(e),e}))}}},5026:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.throttle=void 0;const n=r(4128),s=r(7822);t.throttle=function(e,t,r=1){let i=0,o=[];return function c(a){1===r?o=[a]:(o.length===r&&o.pop(),o.unshift(a)),0===i&&(i=(0,n.setTimeout)((async()=>{const e=o;o=[];try{await t.call(this,e[0],e)}catch(e){(0,s.causeAsyncException)(e)}i=0,o.length>0&&c.call(this,o.shift())}),e))}},t.debounce=function(e,t,r=1){let i=0,o=[],c=!0;return function a(u){1===r?o=[u]:(o.length===r&&o.pop(),o.unshift(u)),0===i&&(i=(0,n.setTimeout)((()=>{i=0,(0,n.setTimeout)((async()=>{if(0!==i)return;if(!c)return;const e=o;o=[],c=!1;try{await t.call(this,e[0],e)}catch(e){(0,s.causeAsyncException)(e)}c=!0,o.length>0&&a.call(this,o.shift())}),e)}),e))}}},8520:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wait=t.setRepeatTimer=t.setTimer=void 0;const n=r(4128),s=r(6288);function i(e){return(t,r,i)=>{let o,c=(0,n.setTimeout)((async function s(){o=[await r()],0!=--e&&(c=(0,n.setTimeout)(s,t))}),t);return(0,s.singleton)((()=>{(0,n.clearTimeout)(c),o&&i?.(o[0])}))}}t.setTimer=i(1),t.setRepeatTimer=i(1/0),t.wait=function(e){return 0===e?Promise.resolve(void 0):new Promise((t=>{(0,n.setTimeout)(t,e)}))}},5341:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tuple=void 0,t.tuple=function(...e){return e}},5177:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPrimitive=t.isType=t.type=void 0;const n=r(4128),s=r(5406),i=Object.prototype.toString.call.bind(Object.prototype.toString),o=Object.prototype,c=Array.prototype;function a(e){if(void 0===e)return"undefined";if(null===e)return"null";const t=typeof e;if("object"===t){if(e[n.Symbol.toStringTag])return e[n.Symbol.toStringTag];const t=(0,s.ObjectGetPrototypeOf)(e);return t===o?"Object":t===c?"Array":i(e).slice(8,-1)}return"function"===t?"Function":t}t.type=a,t.isType=function(e,t){return"object"===t?null!==e&&typeof e===t:"function"===t?typeof e===t:a(e)===t},t.isPrimitive=function(e){const t=typeof e;return"object"!==t&&"function"!==t||null===e}},2261:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.URL=t.ReadonlyURL=t.standardize=void 0;const n=r(4128),s=r(137);var i=r(137);Object.defineProperty(t,"standardize",{enumerable:!0,get:function(){return i.standardize}});var o=r(137);Object.defineProperty(t,"ReadonlyURL",{enumerable:!0,get:function(){return o.ReadonlyURL}});const c=Symbol.for("spica/url::internal");t.URL=class{constructor(e,t){this.source=e,this.base=t,this[c]={url:new s.ReadonlyURL(e,t),searchParams:void 0}}get href(){return this[c].searchParams?.toString().replace(/^(?=.)/,`${this[c].url.href.slice(0,-this[c].url.query.length-this[c].url.fragment.length||this[c].url.href.length)}?`).concat(this.fragment)??this[c].url.href}get resource(){return this[c].searchParams?.toString().replace(/^(?=.)/,`${this[c].url.href.slice(0,-this[c].url.query.length-this[c].url.fragment.length||this[c].url.href.length)}?`)??this[c].url.resource}get origin(){return this[c].url.origin}get scheme(){return this[c].url.protocol.slice(0,-1)}get protocol(){return this[c].url.protocol}get username(){return this[c].url.username}get password(){return this[c].url.password}get host(){return this[c].url.host}get hostname(){return this[c].url.hostname}get port(){return this[c].url.port}get path(){return this[c].searchParams?.toString().replace(/^(?=.)/,`${this.pathname}?`)??this[c].url.path}get pathname(){return this[c].url.pathname}get search(){return this[c].searchParams?.toString().replace(/^(?=.)/,"?")??this[c].url.search}get query(){return this[c].searchParams?.toString().replace(/^(?=.)/,"?")??this[c].url.query}get hash(){return this[c].url.hash}get fragment(){return this[c].url.fragment}get searchParams(){return this[c].searchParams??=new n.URLSearchParams(this.search)}toString(){return this.href}toJSON(){return this.href}}},137:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadonlyURL=t._encode=t.standardize=void 0;const n=r(4128),s=r(1808),i=r(9210);function o(e){return e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[\uDC00-\uDFFF]/g,(e=>2===e.length?e:"")).replace(/%(?![0-9A-F]{2})|[^%\[\]]+/gi,n.encodeURI).replace(/\?[^#]+/,(e=>"?"+e.slice(1).replace(/%[0-9A-F]{2}|%|[^=&]+/gi,(e=>"%"===e[0]&&3===e.length?e:(0,n.encodeURIComponent)(e))))).replace(/%[0-9A-F]{2}/gi,(e=>e.toUpperCase())).replace(/#.+/,e.slice(e.indexOf("#")))}t.standardize=function(e,t){const r=new a(e,t);return o(e="null"===r.origin?r.protocol.toLowerCase()+r.href.slice(r.protocol.length):r.origin.toLowerCase()+r.href.slice(r.origin.length))},t._encode=o;const c=Symbol.for("spica/url::internal");class a{constructor(e,t){switch(this.source=e,this.base=t,e.slice(0,e.lastIndexOf("://",9)+1).toLowerCase()){case"http:":case"https:":t=void 0;break;default:switch(t?.slice(0,t.lastIndexOf("://",9)+1).toLowerCase()){case"http:":case"https:":const r=t.indexOf("#");r>-1&&(t=t.slice(0,r));const n=t.indexOf("?");r>-1&&-1===e.indexOf("#")&&(t=t.slice(0,n))}}this[c]={share:a.get(e,t),searchParams:void 0}}get href(){return this[c].share.href??=this[c].share.url.href}get resource(){return this[c].share.resource??=this.href.slice(0,-this.fragment.length-this.query.length||this.href.length)+this.search}get origin(){return this[c].share.origin??=this[c].share.url.origin}get protocol(){return this[c].share.protocol??=this[c].share.url.protocol}get username(){return this[c].share.username??=this[c].share.url.username}get password(){return this[c].share.password??=this[c].share.url.password}get host(){return this[c].share.host??=this[c].share.url.host}get hostname(){return this[c].share.hostname??=this[c].share.url.hostname}get port(){return this[c].share.port??=this[c].share.url.port}get path(){return this[c].share.path??=`${this.pathname}${this.search}`}get pathname(){return this[c].share.pathname??=this[c].share.url.pathname}get search(){return this[c].share.search??=this[c].share.url.search}get query(){return this[c].share.query??=this.search||"?"===this.href[this.href.length-this.fragment.length-1]&&"?"||""}get hash(){return this[c].share.hash??=this[c].share.url.hash}get fragment(){return this[c].share.fragment??=this.hash||"#"===this.href[this.href.length-1]&&"#"||""}get searchParams(){return this[c].searchParams??=new n.URLSearchParams(this.search)}toString(){return this.href}toJSON(){return this.href}}t.ReadonlyURL=a,a.get=(0,s.memoize)(((e,t)=>({url:new n.global.URL(e,t)})),((e,t="")=>`${t.indexOf("\n")>-1?t.replace(/\n+/g,""):t}\n${e}`),new i.Cache(1e4))},4279:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.Pjax=void 0;var n=r(524);Object.defineProperty(t,"Pjax",{enumerable:!0,get:function(){return n.GUI}}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.GUI}})},2345:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.route=t.scope=t.Config=t.RouterEventSource=t.RouterEventType=t.RouterEvent=void 0;const n=r(6562);var s=r(9401);Object.defineProperty(t,"RouterEvent",{enumerable:!0,get:function(){return s.RouterEvent}}),Object.defineProperty(t,"RouterEventType",{enumerable:!0,get:function(){return s.RouterEventType}}),Object.defineProperty(t,"RouterEventSource",{enumerable:!0,get:function(){return s.RouterEventSource}});var i=r(5411);Object.defineProperty(t,"Config",{enumerable:!0,get:function(){return i.Config}}),Object.defineProperty(t,"scope",{enumerable:!0,get:function(){return i.scope}}),t.route=function(e,t,r,s){return(0,n.route)(new n.RouterEntity(e,t,new n.RouterEntityState(r.process,r.scripts)),s)}},8382:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.savePosition=t.loadTitle=void 0;var n=r(5563);Object.defineProperty(t,"loadTitle",{enumerable:!0,get:function(){return n.loadTitle}}),Object.defineProperty(t,"savePosition",{enumerable:!0,get:function(){return n.savePosition}})},2090:(e,t)=>{"use strict";function r(){window.history.replaceState({...window.history.state,title:document.title},document.title)}function n(){window.history.replaceState({...window.history.state,position:{...window.history.state?.position,top:window.pageYOffset,left:window.pageXOffset}},document.title)}Object.defineProperty(t,"__esModule",{value:!0}),t.savePjax=t.isTransitable=t.savePosition=t.loadPosition=t.saveTitle=t.loadTitle=void 0,r(),n(),t.loadTitle=function(){return window.history.state?.title||document.title},t.saveTitle=r,t.loadPosition=function(){return window.history.state?.position||{top:window.pageYOffset,left:window.pageXOffset}},t.savePosition=n,t.isTransitable=function(e){return!0===e?.pjax?.transition??!1},t.savePjax=function(){window.history.replaceState({...window.history.state,pjax:{...window.history.state?.pjax,transition:!0}},document.title)}},5411:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Config=t.scope=void 0;const n=r(5406),s=r(4401);var i=r(9375);Object.defineProperty(t,"scope",{enumerable:!0,get:function(){return i.scope}});t.Config=class{constructor(e){this.areas=["body"],this.link="a, area",this.form="form:not([method])",this.replace="",this.fetch={rewrite:e=>e,cache:(e,t)=>"",headers:new Headers,timeout:3e3,wait:0},this.update={rewrite:(e,t)=>{},head:"base, meta, link",css:!0,script:!0,ignore:"",ignores:{extension:'[href^="chrome-extension://"]',security:'[src*=".scr.kaspersky-labs.com/"]'},reload:"",logger:""},this.sequence=new o,this.progressbar="display:none;position:absolute;bottom:0;left:0;width:0;height:2px;background:rgb(40, 105, 255);",this.scope={},(0,n.ObjectDefineProperties)(this.update,{ignore:{enumerable:!1,set(e){this.ignores._=e},get(){return(0,n.ObjectKeys)(this.ignores).map((e=>this.ignores[e])).filter((e=>e.trim().length>0)).join(",")}}}),(0,s.extend)(this,e),(0,s.overwrite)(this.scope,e?.scope??{}),this.fetch.headers=new Headers(this.fetch.headers),(0,n.ObjectFreeze)(this),this.fetch.headers.set("X-Requested-With","XMLHttpRequest"),this.fetch.headers.set("X-Pjax","1")}filter(e){return e.matches("[href]:not([target])")}fallback(e,t){if(e instanceof HTMLAnchorElement)window.location.assign(e.href);else if(e instanceof HTMLFormElement)window.location.assign(e.action);else{if(!(e instanceof Window))throw t;window.location.reload()}}};class o{async fetch(){return"fetch"}async unload(){return"unload"}async content(){return"content"}async ready(){return"ready"}async load(){}}},9375:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scope=void 0;const n=r(5406),s=r(5411),i=r(4198),o=r(8715),c=r(6512),a=r(4401),{compare:u}=i.router.helpers();t.scope=function(e,t){const r={"/":{},...e.scope};return o.Sequence.from((0,n.ObjectKeys)(r).sort().reverse()).dropWhile((e=>!u(e,t.orig)&&!u(e,t.dest))).take(1).filter((e=>!!u(e,t.orig)&&u(e,t.dest))).map((e=>r[e])).map((t=>t?(0,c.Just)(new s.Config((0,a.extend)({scope:t.scope&&(0,a.overwrite)(e.scope,t.scope)},e,t))):c.Nothing)).extract()[0]??c.Nothing}},9401:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RouterEventLocation=t.RouterEventRequest=t.RouterEventMethod=t.RouterEventType=t.RouterEventSource=t.RouterEvent=void 0;const n=r(5406),s=r(7274),i=r(2261),o=r(1051);var c,a;t.RouterEvent=class{constructor(e){this.original=e,this.type=this.original.type.toLowerCase(),this.source=this.original[o.currentTarget],this.request=new u(this.source),this.location=new l(this.request.url),(0,n.ObjectFreeze)(this)}},function(e){e.Anchor=HTMLAnchorElement,e.Area=HTMLAreaElement,e.Form=HTMLFormElement,e.Window=window.Window}(c=t.RouterEventSource||(t.RouterEventSource={})),function(e){e.Click="click",e.Submit="submit",e.Popstate="popstate"}(t.RouterEventType||(t.RouterEventType={})),function(e){e.GET="GET",e.POST="POST"}(a=t.RouterEventMethod||(t.RouterEventMethod={}));class u{constructor(e){this.source=e,this.method=(()=>{if(this.source instanceof c.Anchor||this.source instanceof c.Area)return a.GET;if(this.source instanceof c.Form)return this.source.method.toUpperCase()===a.POST?a.POST:a.GET;if(this.source instanceof c.Window)return a.GET;throw new TypeError})(),this.url=(()=>{if(this.source instanceof c.Anchor||this.source instanceof c.Area)return new i.URL((0,i.standardize)(this.source.href,window.location.href));if(this.source instanceof c.Form)return this.source.method.toUpperCase()===a.GET?new i.URL((0,i.standardize)(this.source.action.split(/[?#]/)[0]+`?${(0,s.serialize)(this.source)}`,window.location.href)):new i.URL((0,i.standardize)(this.source.action.split(/[?#]/)[0],window.location.href));if(this.source instanceof c.Window)return new i.URL((0,i.standardize)(window.location.href));throw new TypeError})(),this.body=(()=>this.source instanceof c.Form&&this.method===a.POST?new FormData(this.source):null)(),(0,n.ObjectFreeze)(this)}}t.RouterEventRequest=u;class l{constructor(e){this.dest=e,this.orig=new i.URL((0,i.standardize)(window.location.href)),(0,n.ObjectFreeze)(this)}}t.RouterEventLocation=l},6562:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.route=t.RouterEntityState=t.RouterEntity=void 0;const n=r(1791),s=r(5643),i=r(9218),o=r(5563),c=r(8555);var a=r(5721);Object.defineProperty(t,"RouterEntity",{enumerable:!0,get:function(){return a.RouterEntity}}),Object.defineProperty(t,"RouterEntityState",{enumerable:!0,get:function(){return a.RouterEntityState}}),t.route=async function(e,t){return(0,c.Right)(void 0).bind(e.state.process.either).bind((()=>function(e,t){return(0,i.separate)({src:e,dst:e},t).extract((()=>!1),(()=>!0))}(t.document,e.config.areas)?(0,c.Right)(void 0):(0,c.Left)(new Error("Failed to match areas.")))).fmap((()=>(0,n.fetch)(e.event.request,e.config,e.state.process))).fmap((async r=>(await r).fmap((([r,n])=>(0,s.update)(e,r,n,{document:t.document,position:o.loadPosition}))).extract(c.Left))).extract(c.Left)}},5721:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RouterEntityState=t.RouterEntity=void 0;const n=r(5406);t.RouterEntity=class{constructor(e,t,r){this.config=e,this.event=t,this.state=r,(0,n.ObjectFreeze)(this)}};t.RouterEntityState=class{constructor(e,t){this.process=e,this.scripts=t,(0,n.ObjectFreeze)(this)}}},7624:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchResponse=void 0;const n=r(5406),s=r(6301),i=r(2261);t.FetchResponse=class{constructor(e,t){if(this.url=e,this.xhr=t,this.header=e=>this.xhr.getResponseHeader(e),this.document=this.xhr.responseXML.cloneNode(!0),e.origin!==new i.URL(t.responseURL,window.location.href).origin)throw new Error("Redirected to another origin.");(0,n.ObjectDefineProperty)(this.document,"URL",{configurable:!0,enumerable:!0,value:e.href,writable:!1}),(0,s.fix)(this.document),(0,n.ObjectFreeze)(this)}}},1791:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetch=void 0;const n=r(4608),s=r(8520);t.fetch=async function({method:e,url:t,body:r},{fetch:{rewrite:i,cache:o,headers:c,timeout:a,wait:u},sequence:l},h){window.dispatchEvent(new Event("pjax:fetch"));const[d,p]=await Promise.all([await l.fetch(void 0,{path:t.path,method:e,headers:c,body:r}),(0,n.xhr)(e,t,c,r,a,i,o,h),(0,s.wait)(u)]);return p.bind(h.either).fmap((e=>[e,d]))}},4608:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.match_=t.xhr=void 0;const n=r(7624),s=r(4879),i=r(8715),o=r(8555),c=r(9210),a=r(2261),u=new c.Cache(100),l=new c.Cache(100);function h(e,t){return i.Sequence.intersect(i.Sequence.from(r(e||"").sort()),i.Sequence.from(r(t).sort()),((e,t)=>e.localeCompare(t))).take(1).extract().length>0;function r(e){return e.split(/\s*;\s*/).filter((e=>e.length>0))}}t.xhr=function(e,t,r,i,c,d,p,f){(r=new Headers(r)).set("Accept",r.get("Accept")||"text/html");const m=new a.URL((0,a.standardize)(d(t.path),window.location.href));"GET"===e&&l.has(m.path)&&Date.now()>l.get(m.path).expiry&&r.set("If-None-Match",r.get("If-None-Match")||l.get(m.path).etag);const v="GET"===e&&p(m.path,r)||void 0;return new s.AtomicPromise((s=>{if(v&&u.has(v))return s((0,o.Right)(u.get(v)(t,m)));const d=new XMLHttpRequest;d.open(e,m.path,!0);for(const[e,t]of r)d.setRequestHeader(e,t);d.responseType="document",d.timeout=c,d.send(i),d.addEventListener("abort",(()=>{s((0,o.Left)(new Error("Failed to request a page by abort.")))})),d.addEventListener("error",(()=>{s((0,o.Left)(new Error("Failed to request a page by error.")))})),d.addEventListener("timeout",(()=>{s((0,o.Left)(new Error("Failed to request a page by timeout.")))})),d.addEventListener("load",(()=>{(function(e,t){return(0,o.Right)(e).bind((e=>{const r=new a.URL((0,a.standardize)(e.responseURL,window.location.href));switch(!0){case!e.responseURL:return(0,o.Left)(new Error("Failed to get the response URL."));case r.origin!==new a.URL("",window.location.origin).origin:return(0,o.Left)(new Error("Redirected to another origin."));case!/2..|304/.test(`${e.status}`):return(0,o.Left)(new Error("Failed to validate the status of response."));case!e.response:return"GET"===t&&304===e.status&&l.has(r.path)?(0,o.Right)(l.get(r.path).xhr):(0,o.Left)(new Error("Failed to get the response body."));case!h(e.getResponseHeader("Content-Type"),"text/html"):return(0,o.Left)(new Error("Failed to validate the content type of response."));default:return(0,o.Right)(e)}}))})(d,e).fmap((t=>{const r=new a.URL((0,a.standardize)(t.responseURL,window.location.href));if("GET"===e){const e=new Map(t.getResponseHeader("Cache-Control")?t.getResponseHeader("Cache-Control").trim().split(/\s*,\s*/).filter((e=>e.length>0)).map((e=>e.split("=").concat(""))):[]);for(const n of new Set([m.path,r.path]))t.getResponseHeader("ETag")&&!e.has("no-store")?l.set(n,{etag:t.getResponseHeader("ETag"),expiry:e.has("max-age")&&!e.has("no-cache")&&Date.now()+1e3*+e.get("max-age")||0,xhr:t}):l.delete(n)}return(e,s)=>new n.FetchResponse(r.path===s.path||s.path!==m.path&&v?e:r,t)})).fmap((e=>(v&&u.set(v,e),e(t,m)))).extract((e=>{s((0,o.Left)(e))}),(e=>{s((0,o.Right)(e))}))})),f.register((()=>{d.abort()}))}))},t.match_=h},5643:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.update=void 0;const n=r(9401),s=r(4664),i=r(2139),o=r(954),c=r(6379),a=r(9218),u=r(1340),l=r(5433),h=r(576),d=r(6891),p=r(5563),f=r(4879),m=r(8555),v=r(7536);t.update=function({event:e,config:t,state:r},y,b,g){const{process:w}=r,S={src:y.document,dst:g.document};return f.AtomicPromise.resolve(b).then(w.either).then((e=>e.bind((()=>(0,a.separate)(S,t.areas).extract((()=>(0,m.Left)(new Error("Failed to separate the areas."))),(()=>e)))).fmap((e=>(window.dispatchEvent(new Event("pjax:unload")),t.sequence.unload(e,{...y,url:y.url.href})))))).then((e=>m.Either.sequence(e))).then(w.promise).then((e=>e.bind((e=>(0,a.separate)(S,t.areas).fmap((([t])=>[e,t])).extract((()=>(0,m.Left)(new Error("Failed to separate the areas."))),w.either))).bind((([e,r])=>(t.update.rewrite(S.src,r),(0,a.separate)(S,t.areas).fmap((([,t])=>[e,t])).extract((()=>(0,m.Left)(new Error("Failed to separate the areas."))),w.either)))))).then(w.promise).then((b=>b.fmap((([b,O])=>(0,v.HList)().add(((0,s.blur)(S.dst),(0,p.savePjax)(),(0,i.url)(new n.RouterEventLocation(y.url),S.src.title,e.type,e.source,t.replace),(0,p.savePjax)(),(0,o.title)(S),(0,p.saveTitle)(),(0,c.head)(S,t.update.head,t.update.ignore),w.either((0,a.content)(S,O)).fmap((([e,t])=>[e,f.AtomicPromise.all(t)])))).unfold((async n=>(await n).fmap((async([n])=>{t.update.css&&(0,u.css)(S,t.update.ignore),g.document.dispatchEvent(new Event("pjax:content"));const s=await t.sequence.content(b,n),i=t.update.script?await(0,l.script)(S,r.scripts,t.update,10*Math.max(t.fetch.timeout,1e3),w):await w.either([[],f.AtomicPromise.resolve(w.either([]))]);return(0,h.focus)(e.type,S.dst),(0,d.scroll)(e.type,S.dst,{hash:e.location.dest.fragment,position:g.position}),(0,p.savePosition)(),g.document.dispatchEvent(new Event("pjax:ready")),[i.fmap((([e,t])=>[e,t.then((e=>e.extract()))])),await t.sequence.ready(s)]})).fmap((e=>e.then((([e,t])=>e.fmap((e=>[e,t])))))).extract((e=>f.AtomicPromise.resolve((0,m.Left)(e)))))).reverse())))).then(w.promise).then((e=>e.fmap((([e,r])=>(f.AtomicPromise.all([e,r]).then((([e,r])=>e.bind((([,e])=>r.fmap((([[,r],n])=>{f.AtomicPromise.all([e,r]).then(w.either).then((e=>e.fmap((([e])=>(window.dispatchEvent(new Event("pjax:load")),void t.sequence.load(n,e)))).extract((()=>{}))))})))).extract((()=>{})))),r))))).then((e=>m.Either.sequence(e).then((e=>e.join())))).then((e=>e.fmap((([e])=>e))))}},4664:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.blur=void 0,t.blur=function(e){e===window.document&&e.activeElement!==e.body&&(e.activeElement.blur(),e.body.focus())}},9218:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._wait=t._split=t.separate=t.content=void 0;const n=r(5433),s=r(4879),i=r(6512),o=r(8112),c=r(1051);function a(e){return(e.match(/(?:[^,\(\[]+|\(.*?\)|\[.*?\])+/g)||[]).map((e=>e.trim())).reduce(((e,t)=>t?e.fmap((e=>(0,o.push)(e,[t]))):i.Nothing),(0,i.Just)([]))}function u(e){return s.AtomicPromise.race([new s.AtomicPromise((t=>{(0,c.once)(e,"load",t)})),new s.AtomicPromise((t=>{(0,c.once)(e,"abort",t)})),new s.AtomicPromise((t=>{(0,c.once)(e,"error",t)}))])}t.content=function(e,t,r={replace:(e,t)=>{t.parentNode.replaceChild(e,t)}}){return[t.map((e=>e.dst)).reduce(o.push,[]),t.map((function(t){return t.src.map(((r,n)=>({src:e.dst.importNode(t.src[n].cloneNode(!0),!0),dst:t.dst[n]}))).map((e=>(function(e){const t=[...e.src.querySelectorAll("script")].map(n.escape).reduce(((e,t)=>()=>(e(),void t())),(()=>{}));r.replace(e.src,e.dst),t()}(e),[...e.src.querySelectorAll("img, iframe, frame")].map(u)))).reduce(o.push,[])})).reduce(o.push,[])]},t.separate=function(e,t){return t.reduce(((t,r)=>i.Maybe.mplus(t,function(e,t){return a(t).bind((t=>t.reduce(((t,r)=>t.bind((t=>{const n={src:[...e.src.querySelectorAll(r)],dst:[...e.dst.querySelectorAll(r)]};return n.src.length>0&&n.src.length===n.dst.length?(0,i.Just)((0,o.push)(t,[n])):i.Nothing}))),(0,i.Just)([]))))}(e,r).fmap((e=>[r,e])))),i.Nothing)},t._split=a,t._wait=u},1340:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=void 0;const n=r(4501);t.css=function(e,t){return void["head","body"].map((t=>[e.src.querySelector(t),e.dst.querySelector(t)])).forEach((([e,t])=>{(0,n.sync)((0,n.pair)(r(e),r(t),((e,t)=>e.outerHTML===t.outerHTML)),t)}));function r(e){return[...e.querySelectorAll('link[rel~="stylesheet"], style')].filter((e=>!t||!e.matches(t)))}}},576:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.focus=void 0;const n=r(9401);t.focus=function(e,t){switch(e){case n.RouterEventType.Click:case n.RouterEventType.Submit:return void[...t.querySelectorAll("[autofocus]")].slice(-1).filter((e=>e.closest("html")===window.document.documentElement&&e!==t.activeElement)).forEach((e=>{e.focus()}));case n.RouterEventType.Popstate:return;default:throw new TypeError(e)}}},6379:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.head=void 0;const n=r(4501);t.head=function(e,t,r){return r+=t.includes("link")?', link[rel~="stylesheet"]':"",void(0,n.sync)((0,n.pair)(s(e.src.head),s(e.dst.head),((e,t)=>e.outerHTML===t.outerHTML)),e.dst.head);function s(e){return[...e.querySelectorAll(t)].filter((e=>!r||!e.matches(r)))}}},5433:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.escape=t._evaluate=t._fetch=t.script=void 0;const o=r(4128),c=r(5406),a=r(2893),u=r(4879),l=r(8555),h=r(2261),d=r(8112),p=r(5341),f=r(8520),m=r(3252);async function v(e,t){return e.hasAttribute("src")?"module"===e.type.toLowerCase()?(0,l.Right)([e,""]):u.AtomicPromise.race([window.fetch(e.src,{headers:new Headers({Accept:"application/javascript"}),integrity:e.integrity}),(0,f.wait)(t).then((()=>u.AtomicPromise.reject(new Error(`${e.src}: Timeout.`))))]).then((async t=>t.ok?(0,l.Right)([e,await t.text()]):e.matches("[src][async]")?g(e).then((()=>(0,l.Right)([e,""])),(()=>(0,l.Left)(new Error(`${e.src}: ${t.statusText}`)))):(0,l.Left)(new Error(t.statusText))),(e=>(0,l.Left)(e))):(0,l.Right)([e,e.text])}function y(e,t,n,s,o,c){const d=!!(e=e.ownerDocument===document?e:document.importNode(e.cloneNode(!0),!0)).parentElement&&e.parentElement.matches(n.trim()||"_"),p=document.querySelector(d?e.parentElement.id?`#${e.parentElement.id}`:e.parentElement.tagName:"_")||document.body,f=b(e);p.appendChild(e),f(),!d&&e.remove();const m=u.AtomicPromise.resolve(o).then((function(){if(!c.isAlive)throw new a.FatalError("Expired.");if(e.matches('[type="module"][src]'))return u.AtomicPromise.resolve(Promise.resolve().then((()=>i(r(8442)(e.src))))).catch((t=>t.message.startsWith("Failed to load ")&&e.matches("[src][async]")?g(e).catch((()=>u.AtomicPromise.reject(t))):u.AtomicPromise.reject(t))).then((()=>(e.dispatchEvent(new Event("load")),(0,l.Right)(e))),(t=>(e.dispatchEvent(new Event("error")),(0,l.Left)(new a.FatalError(t instanceof Error?t.message:t+"")))));try{if(s.has(new h.URL((0,h.standardize)(window.location.href)).href))throw new a.FatalError("Expired.");return(0,eval)(t),e.hasAttribute("src")&&e.dispatchEvent(new Event("load")),u.AtomicPromise.resolve((0,l.Right)(e))}catch(t){return e.hasAttribute("src")&&e.dispatchEvent(new Event("error")),u.AtomicPromise.resolve((0,l.Left)(new a.FatalError(t instanceof Error?t.message:t+"")))}}));return e.matches("[src][async]")?(0,l.Right)(m):(0,l.Left)(m)}function b(e){const t=e.hasAttribute("src")?e.getAttribute("src"):null,r=e.text;return e.removeAttribute("src"),e.text="",()=>(e.text=" ",e.text=r,"string"==typeof t?void e.setAttribute("src",t):void 0)}function g(e){return new h.URL((0,h.standardize)(e.src)).origin===new h.URL((0,h.standardize)(window.location.href)).origin?u.AtomicPromise.reject(new Error):(e=(0,m.html)("script",(0,c.ObjectValues)(e.attributes).reduce(((e,{name:t,value:r})=>(e[t]=r,e)),{}),[...e.childNodes]),new u.AtomicPromise(((t,r)=>(e.addEventListener("load",(()=>{t(o.undefined)})),e.addEventListener("error",r),document.body.appendChild(e),void e.remove()))))}t.script=function(e,t,r,n,s,i={fetch:v,evaluate:y}){const o=[...e.src.querySelectorAll("script")].filter((e=>!e.type||/(?:application|text)\/(?:java|ecma)script|module/i.test(e.type))).filter((e=>!e.matches(r.ignore.trim()||"_"))).filter((e=>!e.hasAttribute("src")||(!t.has(new h.URL((0,h.standardize)(e.src)).href)||e.matches(r.reload.trim()||"_")))),{ss:c,as:a}=o.reduce(((e,t)=>{if(!0===t.matches("[src][async], [src][defer]"))e.as.push(t);else e.ss.push(t);return e}),{ss:[],as:[]});return u.AtomicPromise.all([u.AtomicPromise.all(f(c)).then(m),u.AtomicPromise.all(f(a)).then(m)]).then((async([e,t])=>e.fmap((async e=>(await e).fmap((([e,r])=>[e,r.then((async e=>t.fmap((async t=>(await t).fmap((([t,r])=>u.AtomicPromise.all([e,(0,l.Right)(t),r]).then((e=>e.reduce(((e,t)=>e.bind((e=>t.fmap((t=>(0,d.push)(e,t))))))))))).extract(l.Left))).extract(l.Left)))])))).extract(l.Left)));function f(e){return e.map((e=>i.fetch(e,n)))}function m(e){return e.reduce(((e,t)=>t.bind((()=>e))),e.reduce(((e,n)=>e.bind(s.either).bind((([e,o])=>n.fmap((([n,o])=>i.evaluate(n,o,r.logger,t,u.AtomicPromise.all(e),s))).bind((t=>t.extract((t=>(0,l.Right)((0,p.tuple)((0,d.push)(e,[t]),o))),(t=>(0,l.Right)((0,p.tuple)(e,(0,d.push)(o,[t])))))))))),(0,l.Right)([[],[]]))).fmap((([e,t])=>u.AtomicPromise.all(e).then((e=>l.Either.sequence(e))).then((e=>e.fmap((e=>(0,p.tuple)(e,Promise.all(t).then((e=>l.Either.sequence(e))))))))))}},t._fetch=v,t._evaluate=y,t.escape=b},6891:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._hash=t.scroll=void 0;const n=r(9401);function s(e,t,r={scrollToElement:e=>{e.scrollIntoView()}}){const n=t.slice(1);if(0===n.length)return!1;const s=e.getElementById(n)||e.getElementsByName(n)[0];return!!s&&(r.scrollToElement(s),!0)}t.scroll=function(e,t,r,i={scrollToElement:e=>{e.scrollIntoView()},scrollToPosition:({top:e,left:t})=>{window.scrollTo(t,e)},hash:s}){switch(e){case n.RouterEventType.Click:if(i.hash(t,r.hash,i))return;return void i.scrollToPosition({top:0,left:0});case n.RouterEventType.Submit:return void i.scrollToPosition({top:0,left:0});case n.RouterEventType.Popstate:return void i.scrollToPosition(r.position());default:throw new TypeError(e)}},t._hash=s},4501:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pair=t.sync=void 0;const n=r(8555),s=r(8112);function i(e,t,r){t.map((t=>e.ownerDocument.importNode(t.cloneNode(!0),!0))).forEach((t=>{e.insertBefore(t,r)}))}function o(e){e.remove()}t.sync=function(e,t,r={before:i,remove:o}){return void e.forEach((([e,n])=>(r.before(function(e){return e?e.parentElement:t}(n),e.slice(-1).some((e=>!!n&&e.outerHTML===n.outerHTML))?e.slice(0,-1):e,n),n&&0===e.length?void r.remove(n):void 0)))},t.pair=function(e,t,r){const i=function(e,t,r){return e.reduce(((e,i)=>0===t.length?e.set(null,(0,s.push)(e.get(null)||[],[i])):t.reduce(((e,t)=>e.bind((e=>!e.has(t)&&r(i,t)?(e.set(t,(0,s.push)(e.get(null)||[],[i])),e.delete(null),(0,n.Left)(e)):(0,n.Right)(e)))),(0,n.Right)(e)).fmap((e=>e.set(null,(0,s.push)(e.get(null)||[],[i])))).extract((e=>e))),new Map)}(e,t,r);return t.filter((e=>!i.has(e))).forEach((e=>{i.set(e,[])})),[...i].map((([e,t])=>[t,e]))}},954:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.title=void 0,t.title=function(e){e.dst.title=e.src.title}},2139:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._isReplaceable=t._isRegisterable=t.url=void 0;const n=r(9401);function s(e,t){if(t.dest.href===t.orig.href)return!1;switch(e){case n.RouterEventType.Click:case n.RouterEventType.Submit:return!0;case n.RouterEventType.Popstate:return!1;default:throw new TypeError(e)}}function i(e,t,r){switch(e){case n.RouterEventType.Click:case n.RouterEventType.Submit:return t.matches(r.trim()||"_");case n.RouterEventType.Popstate:return!1;default:throw new TypeError(e)}}(0,r(1051).bind)(document,"pjax:ready",(()=>{window.history.replaceState(window.history.state,window.document.title)})),t.url=function(e,t,r,n,o){switch(!0){case i(r,n,o):return void window.history.replaceState({},t,e.dest.href);case s(r,e):return void window.history.pushState({},t,e.dest.href);default:return}},t._isRegisterable=s,t._isReplaceable=i},5563:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),s(r(2090),t)},6629:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ClickView=void 0;const n=r(7983),s=r(1051);class i extends n.Coroutine{constructor(e,t,r){super((async function*(){return this.finally((0,s.delegate)(e,t,"click",(e=>{(e.currentTarget instanceof HTMLAnchorElement||e.currentTarget instanceof HTMLAreaElement)&&r(e)})))}),{delay:!1})}}t.ClickView=i},42:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NavigationView=void 0;const n=r(9114),s=r(2090),i=r(7983),o=r(2261),c=r(1051);class a extends i.Coroutine{constructor(e,t){super((async function*(){return this.finally((0,c.bind)(e,"popstate",(r=>{(0,s.isTransitable)(n.page.state)&&(0,s.isTransitable)(e.history.state)&&(0,o.standardize)(e.location.href)!==n.page.href&&t(r)})))}),{delay:!1})}}t.NavigationView=a},9078:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScrollView=void 0;const n=r(9114),s=r(7983),i=r(2261),o=r(5026),c=r(1051);class a extends s.Coroutine{constructor(e,t){super((async function*(){return this.finally((0,c.bind)(e,"scroll",(0,o.debounce)(100,(r=>{(0,i.standardize)(e.location.href)===n.page.href&&t(r)})),{passive:!0}))}),{delay:!1})}}t.ScrollView=a},2217:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SubmitView=void 0;const n=r(7983),s=r(1051);class i extends n.Coroutine{constructor(e,t,r){super((async function*(){return this.finally((0,s.delegate)(e,t,"submit",(e=>{e.currentTarget instanceof HTMLFormElement&&r(e)})))}),{delay:!1})}}t.SubmitView=i},8411:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.API=void 0;const n=r(574),s=r(4318),i=r(2090),o=r(6301),c=r(4401),a=r(1051);function u(e,t){const r=document.createElement("a");r.href=e,(0,o.parse)("").extract().body.appendChild(r),(0,a.once)(r,"click",t),(0,a.once)(r,"click",(e=>{e.preventDefault()})),r.click()}t.API=class{static assign(e,t,r={document:window.document,router:n.route}){let i;return u(e,(e=>i=r.router(new n.Config(t),new n.RouterEvent(e),s.process,r))),i}static replace(e,t,r={document:window.document,router:n.route}){let i;return u(e,(e=>i=r.router(new n.Config((0,c.assign)({},t,{replace:"*"})),new n.RouterEvent(e),s.process,r))),i}static sync(e){e&&(0,i.savePjax)(),s.process.cast("",new Error("Canceled.")),(0,n.sync)()}static pushURL(e,t,r=null){window.history.pushState(r,t,e),this.sync()}static replaceURL(e,t,r=window.history.state){const n=(0,i.isTransitable)(window.history.state);window.history.replaceState(r,t,e),this.sync(n)}}},524:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GUI=void 0;const n=r(8411),s=r(6629),i=r(2217),o=r(42),c=r(9078),a=r(574);r(4650);const u=r(4318),l=r(8382),h=r(7780),d=r(7596);class p extends n.API{constructor(e,t={document:window.document,router:a.route}){super(),this.option=e,this.io=t,this.view=new f(this.option,this.io),p.resources.clear(),p.resources.register("view",this.view)}assign(e){return n.API.assign(e,this.option,this.io)}replace(e){return n.API.replace(e,this.option,this.io)}}t.GUI=p,p.resources=new class extends h.Supervisor{};class f extends d.Copropagator{constructor(e,t){const r=new a.Config(e),n=e=>{t.router(r,new a.RouterEvent(e),u.process,t)};super([new s.ClickView(t.document,r.link,n),new i.SubmitView(t.document,r.form,n),new o.NavigationView(window,n),new c.ScrollView(window,l.savePosition)])}}},574:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._validate=t.sync=t.route=t.RouterEventSource=t.RouterEvent=t.Config=void 0;const n=r(2345);Object.defineProperty(t,"Config",{enumerable:!0,get:function(){return n.Config}}),Object.defineProperty(t,"RouterEvent",{enumerable:!0,get:function(){return n.RouterEvent}}),Object.defineProperty(t,"RouterEventSource",{enumerable:!0,get:function(){return n.RouterEventSource}});const s=r(9114),i=r(608),o=r(2893),c=r(8382),a=r(2261),u=r(412),l=r(6512),h=r(4879);function d(e,t,r){if(r.original.defaultPrevented)return!1;switch(r.type){case n.RouterEventType.Click:return o(e)&&(i=e,!(new a.URL(s.page.href).resource===i.resource&&""!==i.fragment))&&!p(e)&&!r.source.hasAttribute("download")&&!function(e){return e.which>1||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey}(r.original)&&t.filter(r.source);case n.RouterEventType.Submit:return o(e);case n.RouterEventType.Popstate:return o(e)&&!p(e);default:return!1}var i;function o(e){return new a.URL(s.page.href).origin===e.origin}}function p(e){const t=new a.URL(s.page.href);return t.resource===e.resource&&t.fragment!==e.fragment}(0,r(1051).bind)(window,"pjax:unload",(()=>window.history.scrollRestoration="auto"),!0),t.route=function(e,t,r,f){switch(t.type){case n.RouterEventType.Click:case n.RouterEventType.Submit:(0,c.savePosition)();break;case n.RouterEventType.Popstate:f.document.title=(0,c.loadTitle)()}return(0,l.Just)(0).guard(d(t.request.url,e,t)).bind((()=>(0,n.scope)(e,(({orig:e,dest:t})=>({orig:e.pathname,dest:t.pathname}))(t.location)))).fmap((async e=>{t.original.preventDefault(),r.cast("",new Error("Canceled."));const c=new u.Cancellation,l=r.register("",(e=>(l(),c.cancel(e),h.never))),[d]=await i.env;return window.history.scrollRestoration="manual",(0,n.route)(e,t,{process:c,scripts:d},f).then((e=>e.fmap((async([e,t])=>(l(),s.page.sync(),e.filter((e=>e.hasAttribute("src"))).forEach((e=>{d.add(new a.URL((0,a.standardize)(e.src)).href)})),void(await t).filter((e=>e.hasAttribute("src"))).forEach((e=>{d.add(new a.URL((0,a.standardize)(e.src)).href)}))))).extract())).catch((r=>(l(),s.page.sync(),window.history.scrollRestoration="auto",c.isAlive||r instanceof o.FatalError?void e.fallback(t.source,r):void 0)))})).extract((()=>{switch(t.type){case n.RouterEventType.Click:return t.source.matches("[href]")&&r.cast("",new Error("Canceled.")),s.page.sync(),!1;case n.RouterEventType.Submit:return r.cast("",new Error("Canceled.")),s.page.sync(),!1;case n.RouterEventType.Popstate:return p(t.location.dest)?(r.cast("",new Error("Canceled.")),s.page.sync(),!1):(e.fallback(t.source,new Error("Disabled.")),s.page.sync(),!0)}}),(()=>!0))},t.sync=function(){s.page.sync()},t._validate=d},608:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.env=void 0;const n=r(182);t.env=Promise.all([n.scripts,new Promise((e=>{setTimeout(e)}))])},9114:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.page=void 0;const n=r(4128),s=r(2090),i=r(2261),o=r(1051);(0,o.bind)(n.window,"hashchange",(()=>{t.page.sync()})),(0,o.bind)(n.window,"popstate",(()=>(0,s.isTransitable)(t.page.state)&&(0,s.isTransitable)(n.window.history.state)||void t.page.sync())),t.page=new class{constructor(){this.url=(0,i.standardize)(n.window.location.href),this.state_=n.window.history.state}get href(){return this.url}get state(){return this.state_}sync(){this.url=(0,i.standardize)(n.window.location.href),this.state_=n.window.history.state}}},4318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.process=void 0;const n=r(7780);t.process=new class extends n.Supervisor{}},182:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scripts=void 0;const n=r(2261),s=r(1051);t.scripts=new Set,(0,s.bind)(window,"pjax:unload",(()=>{document.querySelectorAll("script[src]").forEach((e=>{t.scripts.add(new n.URL((0,n.standardize)(e.src)).href)}))}))},4650:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});(0,r(1051).bind)(window,"unload",(()=>window.history.scrollRestoration="auto"),!1)},7274:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=void 0,t.serialize=function(e){return[...e.elements].filter((e=>{if(!("name"in e))return!1;if(e.disabled)return!1;switch(e.tagName){case"INPUT":switch(e.type.toLowerCase()){case"checkbox":case"radio":return e.checked;case"submit":case"button":case"image":case"reset":case"file":return!1;default:return!0}case"SELECT":case"TEXTAREA":return!0;default:return!1}})).map((e=>[encodeURIComponent(t(e.name)),encodeURIComponent(t(e.value))].join("="))).join("&");function t(e){return e.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[\uDC00-\uDFFF]/g,(e=>2===e.length?e:""))}}},2893:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FatalError=void 0;class r extends Error{constructor(e){super(e)}}t.FatalError=r,Error.prototype.name="Error",r.prototype.name="FatalError"},6301:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._fixNoscript=t.fix=t.parse=void 0;const n=r(6512),s=r(8555);function i(e){o(e).forEach((([e,t])=>e.textContent=t.textContent))}function o(e){return[...e.querySelectorAll("noscript")].filter((e=>e.children.length>0)).map((e=>{const t=e.cloneNode(!0);return t.textContent=e.innerHTML,[e,t]}))}t.parse=[function(e){const t=(new DOMParser).parseFromString(e,"text/html");return i(t),t},function(e){const t=window.document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),i(t),t}].reduce(((e,t)=>e.bind((()=>function(e){try{const t=e('\n<html lang="en" class="html">\n  <head>\n    <link href="/">\n    <title>&amp;</title>\n    <noscript><style>/**/</style></noscript>\n  </head>\n  <body>\n    <noscript>noscript</noscript>\n    <a href="/"></a>\n    <script>document.head.remove();<\/script>\n    <img src="abc">\n  </body>\n</html>\n');switch(!1){case"&"===t.title:case!!t.querySelector('html.html[lang="en"]'):case!!t.querySelector("head > link").href:case!!t.querySelector("body > a").href:case!t.querySelector("head > noscript > *"):case"document.head.remove();"===t.querySelector("script").innerHTML:case t.querySelector("img").src.endsWith("abc"):case"<style>/**/</style>"===t.querySelector("head > noscript").textContent:case"noscript"===t.querySelector("body > noscript").textContent:throw void 0}return!0}catch{return!1}}(t)?(0,s.Left)(t):e))),(0,s.Right)((()=>n.Nothing))).extract((e=>t=>(0,n.Just)(e(t)))),t.fix=i,t._fixNoscript=o},3252:e=>{
/*! typed-dom v0.0.292 https://github.com/falsandtru/typed-dom | (c) 2016, falsandtru | (Apache-2.0 AND MPL-2.0) License */
var t;globalThis,t=()=>(()=>{"use strict";var e={406:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=t.ObjectValues=t.ObjectSetPrototypeOf=t.ObjectSeal=t.ObjectPreventExtensions=t.ObjectKeys=t.isSealed=t.isFrozen=t.isExtensible=t.ObjectIs=t.ObjectGetPrototypeOf=t.ObjectGetOwnPropertySymbols=t.ObjectGetOwnPropertyNames=t.ObjectGetOwnPropertyDescriptors=t.ObjectGetOwnPropertyDescriptor=t.ObjectFromEntries=t.ObjectFreeze=t.ObjectEntries=t.ObjectDefineProperty=t.ObjectDefineProperties=t.ObjectCreate=t.ObjectAssign=t.toString=t.isEnumerable=t.isPrototypeOf=t.hasOwnProperty=t.SymbolKeyFor=t.SymbolFor=t.sign=t.round=t.random=t.min=t.max=t.floor=t.ceil=t.abs=t.parseInt=t.parseFloat=t.isSafeInteger=t.isNaN=t.isInteger=t.isFinite=t.NaN=void 0,t.NaN=Number.NaN,t.isFinite=Number.isFinite,t.isInteger=Number.isInteger,t.isNaN=Number.isNaN,t.isSafeInteger=Number.isSafeInteger,t.parseFloat=Number.parseFloat,t.parseInt=Number.parseInt,t.abs=Math.abs,t.ceil=Math.ceil,t.floor=Math.floor,t.max=Math.max,t.min=Math.min,t.random=Math.random,t.round=Math.round,t.sign=Math.sign,t.SymbolFor=Symbol.for,t.SymbolKeyFor=Symbol.keyFor,t.hasOwnProperty=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),t.isPrototypeOf=Object.prototype.isPrototypeOf.call.bind(Object.prototype.isPrototypeOf),t.isEnumerable=Object.prototype.propertyIsEnumerable.call.bind(Object.prototype.propertyIsEnumerable),t.toString=Object.prototype.toString.call.bind(Object.prototype.toString),t.ObjectAssign=Object.assign,t.ObjectCreate=Object.create,t.ObjectDefineProperties=Object.defineProperties,t.ObjectDefineProperty=Object.defineProperty,t.ObjectEntries=Object.entries,t.ObjectFreeze=Object.freeze,t.ObjectFromEntries=Object.fromEntries,t.ObjectGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,t.ObjectGetOwnPropertyDescriptors=Object.getOwnPropertyDescriptors,t.ObjectGetOwnPropertyNames=Object.getOwnPropertyNames,t.ObjectGetOwnPropertySymbols=Object.getOwnPropertySymbols,t.ObjectGetPrototypeOf=Object.getPrototypeOf,t.ObjectIs=Object.is,t.isExtensible=Object.isExtensible,t.isFrozen=Object.isFrozen,t.isSealed=Object.isSealed,t.ObjectKeys=Object.keys,t.ObjectPreventExtensions=Object.preventExtensions,t.ObjectSeal=Object.seal,t.ObjectSetPrototypeOf=Object.setPrototypeOf,t.ObjectValues=Object.values,t.isArray=Array.isArray},529:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.equal=void 0,t.equal=function(e,t){return e==e?e===t:t!=t}},128:(e,t,r)=>{r(921);const n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||Function("return this")();n.global=n,e.exports=n},921:()=>{},808:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.reduce=t.memoize=void 0;const n=r(128),s=r(406),i=r(529);t.memoize=function e(t,r=((...e)=>e[0]),i){if("object"==typeof r)return e(t,void 0,r);if(void 0===i)return e(t,r,new n.Map);if((0,s.isArray)(i))return e(t,r,{has:e=>void 0!==i[e],get:e=>i[e],set(e,t){return i[e]=t,this},delete(){throw 0}});let o=!1;return(...e)=>{const n=r(...e);let s=i.get(n);return void 0!==s||o&&i.has(n)||(s=t(...e),o||=void 0===s,i.set(n,s)),s}},t.reduce=function(e,t=((...e)=>e[0])){let r=[],n=[];return(...s)=>{const o=t(...s);return(0,i.equal)(r,o)||(r=o,n=e(...s)),n}}},521:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defrag=t.prepend=t.append=t.isChildren=t.define=t.element=t.text=t.svg=t.html=t.frag=t.shadow=void 0;const n=r(128),s=r(406),i=r(808);var o;function c(e,t){const r=(0,i.memoize)(a,((e,t,r)=>`${t}:${r}`));return(n,s,i)=>{const o=n.includes("-")?a(e,t,n):r(e,t,n).cloneNode(!0);return!s||h(s)?l(o,s??i):l(u(o,s),i)}}function a(e,t,r){if(!("createElement"in e))throw new Error("TypedDOM: Scoped custom elements are not supported on this browser.");switch(t){case"HTML":return e.createElement(r);case"SVG":return e.createElementNS("http://www.w3.org/2000/svg",r);case"MathML":return e.createElementNS("http://www.w3.org/1998/Math/MathML",r)}}function u(e,t){for(const r in t){if(!(0,s.hasOwnProperty)(t,r))continue;const n=t[r];switch(typeof n){case"string":if(e.setAttribute(r,n),r.startsWith("on")){const t=r.slice(2).toLowerCase();switch(t){case"mutate":case"connect":case"disconnect":const r=`on${t}`;e[r]??(0,s.ObjectDefineProperty)(e,r,{configurable:!0,enumerable:!1,writable:!0,value:r in e?e=>e.returnValue:""})}}continue;case"function":if(r.length<3)throw new Error(`TypedDOM: Attribute names for event listeners must have an event name but got "${r}".`);const t=r.split(/\s+/);for(const r of t){if(!r.startsWith("on"))throw new Error(`TypedDOM: Attribute names for event listeners must start with "on" but got "${r}".`);const t=r.slice(2).toLowerCase();switch(e.addEventListener(t,n,{passive:["wheel","mousewheel","touchstart","touchmove","touchend","touchcancel"].includes(t)}),t){case"mutate":case"connect":case"disconnect":const r=`on${t}`;e[r]??(0,s.ObjectDefineProperty)(e,r,{configurable:!0,enumerable:!1,writable:!0,value:r in e?e=>e.returnValue:""})}}continue;case"object":e.removeAttribute(r);continue;default:continue}}return e}function l(e,t){if(void 0===t)return e;if("string"==typeof t)e.textContent=t;else if((0,s.isArray)(t)&&!e.firstChild)for(let r=0;r<t.length;++r){const n=t[r];"object"==typeof n?e.appendChild(n):e.append(n)}else e.replaceChildren(...t);return e}function h(e){return!!e?.[n.Symbol.iterator]}!function(e){e.shadows=new WeakMap,e.shadow=(0,i.memoize)(((e,t)=>e.attachShadow(t)),e.shadows),e.fragment=n.document.createDocumentFragment()}(o||(o={})),t.shadow=function e(r,n,s,i=t.html){return"string"==typeof r?e(i(r),n,s,i):"function"==typeof n?e(r,void 0,s,n):"function"==typeof s?e(r,n,void 0,s):h(n)?e(r,void 0,n,i):l(n?"open"===n.mode?r.shadowRoot??r.attachShadow(n):o.shadows.get(r)??o.shadow(r,n):r.shadowRoot??o.shadows.get(r)??r.attachShadow({mode:"open"}),s)},t.frag=function(e){return l(o.fragment.cloneNode(!0),e)},t.html=c(n.document,"HTML"),t.svg=c(n.document,"SVG"),t.text=function(e){return n.document.createTextNode(e)},t.element=c,t.define=function(e,t,r){return!t||h(t)?l(e,t??r):l(u(e,t),r)},t.isChildren=h,t.append=function(e,t){if(void 0===t)return e;if("string"==typeof t)e.append(t);else for(const r of t)"object"==typeof r?e.appendChild(r):e.append(r);return e},t.prepend=function(e,t){if(void 0===t)return e;if("string"==typeof t)e.prepend(t);else for(const r of t)"object"==typeof r?e.insertBefore(r,null):e.prepend(r);return e},t.defrag=function(e){const t=[];let r=!1;for(let n=0;n<e.length;++n){const s=e[n];""!==s&&("string"==typeof s?(r?t[t.length-1]+=s:t.push(s),r=!0):(t.push(s),r=!1))}return t}}},t={},r=function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(521);return r})(),e.exports=t()},1051:e=>{
/*! typed-dom v0.0.292 https://github.com/falsandtru/typed-dom | (c) 2016, falsandtru | (Apache-2.0 AND MPL-2.0) License */
var t;globalThis,t=()=>(()=>{"use strict";var e={406:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isArray=t.ObjectValues=t.ObjectSetPrototypeOf=t.ObjectSeal=t.ObjectPreventExtensions=t.ObjectKeys=t.isSealed=t.isFrozen=t.isExtensible=t.ObjectIs=t.ObjectGetPrototypeOf=t.ObjectGetOwnPropertySymbols=t.ObjectGetOwnPropertyNames=t.ObjectGetOwnPropertyDescriptors=t.ObjectGetOwnPropertyDescriptor=t.ObjectFromEntries=t.ObjectFreeze=t.ObjectEntries=t.ObjectDefineProperty=t.ObjectDefineProperties=t.ObjectCreate=t.ObjectAssign=t.toString=t.isEnumerable=t.isPrototypeOf=t.hasOwnProperty=t.SymbolKeyFor=t.SymbolFor=t.sign=t.round=t.random=t.min=t.max=t.floor=t.ceil=t.abs=t.parseInt=t.parseFloat=t.isSafeInteger=t.isNaN=t.isInteger=t.isFinite=t.NaN=void 0,t.NaN=Number.NaN,t.isFinite=Number.isFinite,t.isInteger=Number.isInteger,t.isNaN=Number.isNaN,t.isSafeInteger=Number.isSafeInteger,t.parseFloat=Number.parseFloat,t.parseInt=Number.parseInt,t.abs=Math.abs,t.ceil=Math.ceil,t.floor=Math.floor,t.max=Math.max,t.min=Math.min,t.random=Math.random,t.round=Math.round,t.sign=Math.sign,t.SymbolFor=Symbol.for,t.SymbolKeyFor=Symbol.keyFor,t.hasOwnProperty=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),t.isPrototypeOf=Object.prototype.isPrototypeOf.call.bind(Object.prototype.isPrototypeOf),t.isEnumerable=Object.prototype.propertyIsEnumerable.call.bind(Object.prototype.propertyIsEnumerable),t.toString=Object.prototype.toString.call.bind(Object.prototype.toString),t.ObjectAssign=Object.assign,t.ObjectCreate=Object.create,t.ObjectDefineProperties=Object.defineProperties,t.ObjectDefineProperty=Object.defineProperty,t.ObjectEntries=Object.entries,t.ObjectFreeze=Object.freeze,t.ObjectFromEntries=Object.fromEntries,t.ObjectGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,t.ObjectGetOwnPropertyDescriptors=Object.getOwnPropertyDescriptors,t.ObjectGetOwnPropertyNames=Object.getOwnPropertyNames,t.ObjectGetOwnPropertySymbols=Object.getOwnPropertySymbols,t.ObjectGetPrototypeOf=Object.getPrototypeOf,t.ObjectIs=Object.is,t.isExtensible=Object.isExtensible,t.isFrozen=Object.isFrozen,t.isSealed=Object.isSealed,t.ObjectKeys=Object.keys,t.ObjectPreventExtensions=Object.preventExtensions,t.ObjectSeal=Object.seal,t.ObjectSetPrototypeOf=Object.setPrototypeOf,t.ObjectValues=Object.values,t.isArray=Array.isArray},288:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.noop=t.id=t.clear=t.singleton=void 0,t.singleton=function(e){let t;return function(...r){return t||(t=[e.call(this,...r)]),t[0]}},t.clear=function(e){return(...t)=>{e(...t)}},t.id=function(e){return e},t.noop=function(){}},128:(e,t,r)=>{r(921);const n="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||Function("return this")();n.global=n,e.exports=n},921:()=>{},879:(e,t,r)=>{var n,s;Object.defineProperty(t,"__esModule",{value:!0}),t.never=t.isPromiseLike=t.Internal=t.AtomicPromise=t.internal=void 0;const i=r(128),o=r(406),c=r(288);t.internal=Symbol.for("spica/promise::internal");class a{constructor(e){this[n]="Promise",this[s]=new u;try{e((e=>{this[t.internal].resolve(e)}),(e=>{this[t.internal].reject(e)}))}catch(e){this[t.internal].reject(e)}}static get[Symbol.species](){return a}static all(e){return new a(((r,n)=>{const s=(0,o.isArray)(e)?e:[...e],c=(0,i.Array)(s.length);let a=!1,u=0;for(let e=0;!a&&e<s.length;++e){const i=s[e];if(d(i)){if(p(i)){const{status:r}=i[t.internal];switch(r.state){case 2:c[e]=r.value,++u;continue;case 3:return n(r.reason)}}i.then((t=>{c[e]=t,++u,u===s.length&&r(c)}),(e=>{n(e),a=!0}))}else c[e]=i,++u}u===s.length&&r(c)}))}static race(e){return new a(((r,n)=>{const s=(0,o.isArray)(e)?e:[...e];for(let e=0;e<s.length;++e){const i=s[e];if(!d(i))return r(i);if(p(i)){const{status:e}=i[t.internal];switch(e.state){case 2:return r(e.value);case 3:return n(e.reason)}}}let i=!1;for(let e=0;!i&&e<s.length;++e)s[e].then((e=>{r(e),i=!0}),(e=>{n(e),i=!0}))}))}static allSettled(e){return new a((r=>{const n=(0,o.isArray)(e)?e:[...e],s=(0,i.Array)(n.length);let c=0;for(let e=0;e<n.length;++e){const i=n[e];if(d(i)){if(p(i)){const{status:r}=i[t.internal];switch(r.state){case 2:s[e]={status:"fulfilled",value:r.value},++c;continue;case 3:s[e]={status:"rejected",reason:r.reason},++c;continue}}i.then((t=>{s[e]={status:"fulfilled",value:t},++c,c===n.length&&r(s)}),(t=>{s[e]={status:"rejected",reason:t},++c,c===n.length&&r(s)}))}else s[e]={status:"fulfilled",value:i},++c}c===n.length&&r(s)}))}static any(e){return new a(((r,n)=>{const s=(0,o.isArray)(e)?e:[...e],c=(0,i.Array)(s.length);let a=!1,u=0;for(let e=0;!a&&e<s.length;++e){const i=s[e];if(!d(i))return r(i);if(p(i)){const{status:n}=i[t.internal];switch(n.state){case 2:return r(n.value);case 3:c[e]=n.reason,++u;continue}}i.then((e=>{r(e),a=!0}),(t=>{c[e]=t,++u,u===s.length&&n(new AggregateError(c,"All promises were rejected"))}))}u===s.length&&n(new AggregateError(c,"All promises were rejected"))}))}static resolve(e){return new a((t=>t(e)))}static reject(e){return new a(((t,r)=>r(e)))}then(e,r){return new a(((n,s)=>this[t.internal].then(n,s,e,r)))}catch(e){return this.then(void 0,e)}finally(e){return this.then(e,e).then((()=>this))}}t.AtomicPromise=a,n=Symbol.toStringTag,s=t.internal;class u{constructor(){this.status={state:0},this.fulfillReactions=[],this.rejectReactions=[]}get isPending(){return 0===this.status.state}resolve(e){if(0===this.status.state){if(!d(e))return this.status={state:2,value:e},this.resume();if(p(e)){const r=e[t.internal];switch(r.status.state){case 2:case 3:return this.status=r.status,this.resume();default:return r.then((()=>(this.status=r.status,this.resume())),(()=>(this.status=r.status,this.resume())))}}this.status={state:1,promise:e},e.then((e=>{this.status={state:2,value:e},this.resume()}),(e=>{this.status={state:3,reason:e},this.resume()}))}}reject(e){if(0===this.status.state)return this.status={state:3,reason:e},this.resume()}then(e,t,r,n){const{status:s,fulfillReactions:i,rejectReactions:o}=this;switch(s.state){case 2:if(0!==i.length)break;return h(e,t,e,r,s.value);case 3:if(0!==o.length)break;return h(e,t,t,n,s.reason)}i.push([e,t,e,r]),o.push([e,t,t,n])}resume(){const{status:e,fulfillReactions:t,rejectReactions:r}=this;switch(e.state){case 0:case 1:return;case 2:if(0!==r.length&&(this.rejectReactions=[]),0===t.length)return;return l(t,e.value),void(this.fulfillReactions=[]);case 3:if(0!==t.length&&(this.fulfillReactions=[]),0===r.length)return;return l(r,e.reason),void(this.rejectReactions=[])}}}function l(e,t){for(let r=0;r<e.length;++r){const n=e[r];h(n[0],n[1],n[2],n[3],t)}}function h(e,t,r,n,s){if(!n)return r(s);try{e(n(s))}catch(e){t(e)}}function d(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}function p(e){return t.internal in e}t.Internal=u,t.isPromiseLike=d,t.never=new class e extends Promise{static get[Symbol.species](){return e}constructor(){super(c.noop)}then(){return this}catch(){return this}finally(){return this}}},251:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bind=t.delegate=t.once=t.listen=t.currentTarget=void 0;const n=r(406),s=r(879),i=r(288);function o(e,t,r,n,i){switch(typeof r){case"string":switch(typeof n){case"function":return c(e,t,r,n,{..."boolean"==typeof i?{capture:i}:i,once:!0});case"object":i={...n,once:!0};break;default:i={once:!0}}return new s.AtomicPromise((n=>{c(e,t,r,n,i)}));case"function":return a(e,t,r,{..."boolean"==typeof n?{capture:n}:n,once:!0});case"object":i={...r,once:!0};break;default:i={once:!0}}return new s.AtomicPromise((r=>{a(e,t,r,i)}))}function c(e,t,r,n,s){return a(e,r,(e=>{const i=e.target.shadowRoot?e.composedPath()[0]?.closest(t):e.target?.closest(t);i&&o(i,r,(t=>{t===e&&n(e)}),s)}),{..."boolean"==typeof s?{capture:!0}:s,capture:!0})}function a(e,r,s,o){switch(r){case"mutate":case"connect":case"disconnect":const t=`on${r}`;e[t]??(0,n.ObjectDefineProperty)(e,t,{configurable:!0,enumerable:!1,writable:!0,value:t in e?e=>e.returnValue:""})}return e.addEventListener(r,c,o),(0,i.singleton)((()=>{e.removeEventListener(r,c,o)}));function c(e){e[t.currentTarget]=e.currentTarget,s(e)}}t.currentTarget=Symbol.for("typed-dom::currentTarget"),t.listen=function(e,t,r,n,s){return"string"==typeof r?c(e,t,r,n,s):a(e,t,r,n)},t.once=o,t.delegate=c,t.bind=a}},t={},r=function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}(251);return r})(),e.exports=t()},8442:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=8442,e.exports=t}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}return r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(8767)})()));
//# sourceMappingURL=/sm/a7ed1070f334b4b44df7851a231d89f5319b6d06a2dfce0bd18e6d0672ff2231.map